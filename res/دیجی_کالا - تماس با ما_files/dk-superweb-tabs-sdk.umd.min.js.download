var SuperWebSDKPackage=(function(k){"use strict";const St=globalThis,Ht=St.ShadowRoot&&(St.ShadyCSS===void 0||St.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Bt=Symbol(),Ae=new WeakMap;let Pe=class{constructor(t,i,s){if(this._$cssResult$=!0,s!==Bt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=i}get styleSheet(){let t=this.o;const i=this.t;if(Ht&&t===void 0){const s=i!==void 0&&i.length===1;s&&(t=Ae.get(i)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),s&&Ae.set(i,t))}return t}toString(){return this.cssText}};const Ni=e=>new Pe(typeof e=="string"?e:e+"",void 0,Bt),Ii=(e,...t)=>{const i=e.length===1?e[0]:t.reduce(((s,r,n)=>s+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1]),e[0]);return new Pe(i,e,Bt)},Wi=(e,t)=>{if(Ht)e.adoptedStyleSheets=t.map((i=>i instanceof CSSStyleSheet?i:i.styleSheet));else for(const i of t){const s=document.createElement("style"),r=St.litNonce;r!==void 0&&s.setAttribute("nonce",r),s.textContent=i.cssText,e.appendChild(s)}},Re=Ht?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let i="";for(const s of t.cssRules)i+=s.cssText;return Ni(i)})(e):e;const{is:Di,defineProperty:Hi,getOwnPropertyDescriptor:Bi,getOwnPropertyNames:Gi,getOwnPropertySymbols:Ki,getPrototypeOf:Yi}=Object,yt=globalThis,Te=yt.trustedTypes,ji=Te?Te.emptyScript:"",zi=yt.reactiveElementPolyfillSupport,ht=(e,t)=>e,$t={toAttribute(e,t){switch(t){case Boolean:e=e?ji:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let i=e;switch(t){case Boolean:i=e!==null;break;case Number:i=e===null?null:Number(e);break;case Object:case Array:try{i=JSON.parse(e)}catch{i=null}}return i}},Gt=(e,t)=>!Di(e,t),Oe={attribute:!0,type:String,converter:$t,reflect:!1,useDefault:!1,hasChanged:Gt};Symbol.metadata??=Symbol("metadata"),yt.litPropertyMetadata??=new WeakMap;let tt=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,i=Oe){if(i.state&&(i.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((i=Object.create(i)).wrapped=!0),this.elementProperties.set(t,i),!i.noAccessor){const s=Symbol(),r=this.getPropertyDescriptor(t,s,i);r!==void 0&&Hi(this.prototype,t,r)}}static getPropertyDescriptor(t,i,s){const{get:r,set:n}=Bi(this.prototype,t)??{get(){return this[i]},set(o){this[i]=o}};return{get:r,set(o){const h=r?.call(this);n?.call(this,o),this.requestUpdate(t,h,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??Oe}static _$Ei(){if(this.hasOwnProperty(ht("elementProperties")))return;const t=Yi(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(ht("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ht("properties"))){const i=this.properties,s=[...Gi(i),...Ki(i)];for(const r of s)this.createProperty(r,i[r])}const t=this[Symbol.metadata];if(t!==null){const i=litPropertyMetadata.get(t);if(i!==void 0)for(const[s,r]of i)this.elementProperties.set(s,r)}this._$Eh=new Map;for(const[i,s]of this.elementProperties){const r=this._$Eu(i,s);r!==void 0&&this._$Eh.set(r,i)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const i=[];if(Array.isArray(t)){const s=new Set(t.flat(1/0).reverse());for(const r of s)i.unshift(Re(r))}else t!==void 0&&i.push(Re(t));return i}static _$Eu(t,i){const s=i.attribute;return s===!1?void 0:typeof s=="string"?s:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,i=this.constructor.elementProperties;for(const s of i.keys())this.hasOwnProperty(s)&&(t.set(s,this[s]),delete this[s]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Wi(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,i,s){this._$AK(t,s)}_$ET(t,i){const s=this.constructor.elementProperties.get(t),r=this.constructor._$Eu(t,s);if(r!==void 0&&s.reflect===!0){const n=(s.converter?.toAttribute!==void 0?s.converter:$t).toAttribute(i,s.type);this._$Em=t,n==null?this.removeAttribute(r):this.setAttribute(r,n),this._$Em=null}}_$AK(t,i){const s=this.constructor,r=s._$Eh.get(t);if(r!==void 0&&this._$Em!==r){const n=s.getPropertyOptions(r),o=typeof n.converter=="function"?{fromAttribute:n.converter}:n.converter?.fromAttribute!==void 0?n.converter:$t;this._$Em=r;const h=o.fromAttribute(i,n.type);this[r]=h??this._$Ej?.get(r)??h,this._$Em=null}}requestUpdate(t,i,s){if(t!==void 0){const r=this.constructor,n=this[t];if(s??=r.getPropertyOptions(t),!((s.hasChanged??Gt)(n,i)||s.useDefault&&s.reflect&&n===this._$Ej?.get(t)&&!this.hasAttribute(r._$Eu(t,s))))return;this.C(t,i,s)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,i,{useDefault:s,reflect:r,wrapped:n},o){s&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??i??this[t]),n!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||s||(i=void 0),this._$AL.set(t,i)),r===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(i){Promise.reject(i)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,n]of this._$Ep)this[r]=n;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[r,n]of s){const{wrapped:o}=n,h=this[r];o!==!0||this._$AL.has(r)||h===void 0||this.C(r,void 0,n,h)}}let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),this._$EO?.forEach((s=>s.hostUpdate?.())),this.update(i)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(i)}willUpdate(t){}_$AE(t){this._$EO?.forEach((i=>i.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((i=>this._$ET(i,this[i]))),this._$EM()}updated(t){}firstUpdated(t){}};tt.elementStyles=[],tt.shadowRootOptions={mode:"open"},tt[ht("elementProperties")]=new Map,tt[ht("finalized")]=new Map,zi?.({ReactiveElement:tt}),(yt.reactiveElementVersions??=[]).push("2.1.1");const Kt=globalThis,Et=Kt.trustedTypes,Ce=Et?Et.createPolicy("lit-html",{createHTML:e=>e}):void 0,xe="$lit$",H=`lit$${Math.random().toFixed(9).slice(2)}$`,ke="?"+H,Fi=`<${ke}>`,j=document,dt=()=>j.createComment(""),pt=e=>e===null||typeof e!="object"&&typeof e!="function",Yt=Array.isArray,qi=e=>Yt(e)||typeof e?.[Symbol.iterator]=="function",jt=`[ 	
\f\r]`,ut=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Le=/-->/g,Ue=/>/g,z=RegExp(`>|${jt}(?:([^\\s"'>=/]+)(${jt}*=${jt}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Me=/'/g,Ne=/"/g,Ie=/^(?:script|style|textarea|title)$/i,Vi=e=>(t,...i)=>({_$litType$:e,strings:t,values:i}),f=Vi(1),B=Symbol.for("lit-noChange"),u=Symbol.for("lit-nothing"),We=new WeakMap,F=j.createTreeWalker(j,129);function De(e,t){if(!Yt(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return Ce!==void 0?Ce.createHTML(t):t}const Qi=(e,t)=>{const i=e.length-1,s=[];let r,n=t===2?"<svg>":t===3?"<math>":"",o=ut;for(let h=0;h<i;h++){const l=e[h];let p,c,d=-1,b=0;for(;b<l.length&&(o.lastIndex=b,c=o.exec(l),c!==null);)b=o.lastIndex,o===ut?c[1]==="!--"?o=Le:c[1]!==void 0?o=Ue:c[2]!==void 0?(Ie.test(c[2])&&(r=RegExp("</"+c[2],"g")),o=z):c[3]!==void 0&&(o=z):o===z?c[0]===">"?(o=r??ut,d=-1):c[1]===void 0?d=-2:(d=o.lastIndex-c[2].length,p=c[1],o=c[3]===void 0?z:c[3]==='"'?Ne:Me):o===Ne||o===Me?o=z:o===Le||o===Ue?o=ut:(o=z,r=void 0);const P=o===z&&e[h+1].startsWith("/>")?" ":"";n+=o===ut?l+Fi:d>=0?(s.push(p),l.slice(0,d)+xe+l.slice(d)+H+P):l+H+(d===-2?h:P)}return[De(e,n+(e[i]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),s]};class ft{constructor({strings:t,_$litType$:i},s){let r;this.parts=[];let n=0,o=0;const h=t.length-1,l=this.parts,[p,c]=Qi(t,i);if(this.el=ft.createElement(p,s),F.currentNode=this.el.content,i===2||i===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(r=F.nextNode())!==null&&l.length<h;){if(r.nodeType===1){if(r.hasAttributes())for(const d of r.getAttributeNames())if(d.endsWith(xe)){const b=c[o++],P=r.getAttribute(d).split(H),E=/([.?@])?(.*)/.exec(b);l.push({type:1,index:n,name:E[2],strings:P,ctor:E[1]==="."?Xi:E[1]==="?"?Zi:E[1]==="@"?ts:At}),r.removeAttribute(d)}else d.startsWith(H)&&(l.push({type:6,index:n}),r.removeAttribute(d));if(Ie.test(r.tagName)){const d=r.textContent.split(H),b=d.length-1;if(b>0){r.textContent=Et?Et.emptyScript:"";for(let P=0;P<b;P++)r.append(d[P],dt()),F.nextNode(),l.push({type:2,index:++n});r.append(d[b],dt())}}}else if(r.nodeType===8)if(r.data===ke)l.push({type:2,index:n});else{let d=-1;for(;(d=r.data.indexOf(H,d+1))!==-1;)l.push({type:7,index:n}),d+=H.length-1}n++}}static createElement(t,i){const s=j.createElement("template");return s.innerHTML=t,s}}function et(e,t,i=e,s){if(t===B)return t;let r=s!==void 0?i._$Co?.[s]:i._$Cl;const n=pt(t)?void 0:t._$litDirective$;return r?.constructor!==n&&(r?._$AO?.(!1),n===void 0?r=void 0:(r=new n(e),r._$AT(e,i,s)),s!==void 0?(i._$Co??=[])[s]=r:i._$Cl=r),r!==void 0&&(t=et(e,r._$AS(e,t.values),r,s)),t}class Ji{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,r=(t?.creationScope??j).importNode(i,!0);F.currentNode=r;let n=F.nextNode(),o=0,h=0,l=s[0];for(;l!==void 0;){if(o===l.index){let p;l.type===2?p=new gt(n,n.nextSibling,this,t):l.type===1?p=new l.ctor(n,l.name,l.strings,this,t):l.type===6&&(p=new es(n,this,t)),this._$AV.push(p),l=s[++h]}o!==l?.index&&(n=F.nextNode(),o++)}return F.currentNode=j,r}p(t){let i=0;for(const s of this._$AV)s!==void 0&&(s.strings!==void 0?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class gt{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,r){this.type=2,this._$AH=u,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return i!==void 0&&t?.nodeType===11&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=et(this,t,i),pt(t)?t===u||t==null||t===""?(this._$AH!==u&&this._$AR(),this._$AH=u):t!==this._$AH&&t!==B&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):qi(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==u&&pt(this._$AH)?this._$AA.nextSibling.data=t:this.T(j.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,r=typeof s=="number"?this._$AC(t):(s.el===void 0&&(s.el=ft.createElement(De(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===r)this._$AH.p(i);else{const n=new Ji(r,this),o=n.u(this.options);n.p(i),this.T(o),this._$AH=n}}_$AC(t){let i=We.get(t.strings);return i===void 0&&We.set(t.strings,i=new ft(t)),i}k(t){Yt(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,r=0;for(const n of t)r===i.length?i.push(s=new gt(this.O(dt()),this.O(dt()),this,this.options)):s=i[r],s._$AI(n),r++;r<i.length&&(this._$AR(s&&s._$AB.nextSibling,r),i.length=r)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t!==this._$AB;){const s=t.nextSibling;t.remove(),t=s}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}}class At{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,r,n){this.type=1,this._$AH=u,this._$AN=void 0,this.element=t,this.name=i,this._$AM=r,this.options=n,s.length>2||s[0]!==""||s[1]!==""?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=u}_$AI(t,i=this,s,r){const n=this.strings;let o=!1;if(n===void 0)t=et(this,t,i,0),o=!pt(t)||t!==this._$AH&&t!==B,o&&(this._$AH=t);else{const h=t;let l,p;for(t=n[0],l=0;l<n.length-1;l++)p=et(this,h[s+l],i,l),p===B&&(p=this._$AH[l]),o||=!pt(p)||p!==this._$AH[l],p===u?t=u:t!==u&&(t+=(p??"")+n[l+1]),this._$AH[l]=p}o&&!r&&this.j(t)}j(t){t===u?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class Xi extends At{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===u?void 0:t}}class Zi extends At{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==u)}}class ts extends At{constructor(t,i,s,r,n){super(t,i,s,r,n),this.type=5}_$AI(t,i=this){if((t=et(this,t,i,0)??u)===B)return;const s=this._$AH,r=t===u&&s!==u||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,n=t!==u&&(s===u||r);r&&this.element.removeEventListener(this.name,this,s),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class es{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){et(this,t)}}const is=Kt.litHtmlPolyfillSupport;is?.(ft,gt),(Kt.litHtmlVersions??=[]).push("3.3.1");const Pt=(e,t,i)=>{const s=i?.renderBefore??t;let r=s._$litPart$;if(r===void 0){const n=i?.renderBefore??null;s._$litPart$=r=new gt(t.insertBefore(dt(),n),n,void 0,i??{})}return r._$AI(e),r};const zt=globalThis;let O=class extends tt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Pt(i,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return B}};O._$litElement$=!0,O.finalized=!0,zt.litElementHydrateSupport?.({LitElement:O});const ss=zt.litElementPolyfillSupport;ss?.({LitElement:O}),(zt.litElementVersions??=[]).push("4.2.1");const G=e=>(t,i)=>{i!==void 0?i.addInitializer((()=>{customElements.define(e,t)})):customElements.define(e,t)};const rs={attribute:!0,type:String,converter:$t,reflect:!1,hasChanged:Gt},ns=(e=rs,t,i)=>{const{kind:s,metadata:r}=i;let n=globalThis.litPropertyMetadata.get(r);if(n===void 0&&globalThis.litPropertyMetadata.set(r,n=new Map),s==="setter"&&((e=Object.create(e)).wrapped=!0),n.set(i.name,e),s==="accessor"){const{name:o}=i;return{set(h){const l=t.get.call(this);t.set.call(this,h),this.requestUpdate(o,l,e)},init(h){return h!==void 0&&this.C(o,void 0,e,h),h}}}if(s==="setter"){const{name:o}=i;return function(h){const l=this[o];t.call(this,h),this.requestUpdate(o,l,e)}}throw Error("Unsupported decorator location: "+s)};function g(e){return(t,i)=>typeof i=="object"?ns(e,t,i):((s,r,n)=>{const o=r.hasOwnProperty(n);return r.constructor.createProperty(n,s),o?Object.getOwnPropertyDescriptor(r,n):void 0})(e,t,i)}function N(e){return g({...e,state:!0,attribute:!1})}const os=(e,t,i)=>(i.configurable=!0,i.enumerable=!0,Reflect.decorate&&typeof t!="object"&&Object.defineProperty(e,t,i),i);function as(e,t){return(i,s,r)=>{const n=o=>o.renderRoot?.querySelector(e)??null;return os(i,s,{get(){return n(this)}})}}const Ft={PROD:"https://api.digikala.com",DEMO:"https://cors.alamut.digikala.com/api/demo-api.digikala.com"},He="prod".toLowerCase()??void 0,qt=Ft[He==="prod"?"PROD":He==="demo"?"DEMO":"PROD"],a={IS_SCROLL_THRESHOLD_MIN:300,IS_SCROLL_THRESHOLD_MAX:330,NAME_SPACE:"superweb:dk:v1:",OLD_NAME_SPACE:"dk:superweb:",UTM_SOURCES:["digikala-superweb","digikala-superweb-pwa"],UTM:{SUPER_WEB:"digikala-superweb"},SKELETON_TABS_COUNT:5,UNITS_PILLAR:{name:"units",path:"/superapp/units/"},DIGIKALA_PILLAR:{name:"digikala",domains:["https://www.digikala.com","https://digikala.com"]},BLACK_FRIDAY_PILLAR:{name:"blackfriday",path:"/landing/black-friday/"},QUERY_PARAMS:{UTM_SOURCE:"utm_source",SUPERWEB_USER:"sa_user",HISTORY:"state_history",TOKEN:"sa_token",REDIRECT:"redirect_url"},HISTORY:{MAX:10,MAX_BYTES:7e3,REDIRECT_API:"api.digikala.com"},API_ENDPOINTS:{PILLARS:`${qt}/v1/super-app/pillars/`,TRACKING:`${qt}/super-app/v1/web/track/`,ONBOARDING:`${qt}/v1/super-app/onboarding/`},TABULAR_HEIGHT:{FULL:82,COMPACT:48},OLD_STORAGE_KEYS:{SUPERWEB_USER:"user",PAGE_STATES:"page_states",TABS:"tabs",SPOTLIGHT_MODAL_VIEWS:"spotlight_modal_views"},NEW_STORAGE_KEYS:{SUPERWEB_USER:"user:v1",PAGE_STATES:"page_states:v1",TABS:"tabs:v1",SPOTLIGHT_MODAL_VIEWS:"spotlight_modal_views:v1",HISTORY:"history:v1",SEEN_ONBOARDING_MODAL:"seen_onboarding_items:v1"},SPOTLIGHT_MODAL:{scrollDelay:250,overlayConfig:{color:"rgba(0, 0, 0, 0.3)"},spotlightConfig:{padding:0,outlineWidth:8,radius:{topLeft:10,topRight:10,bottomRight:10,bottomLeft:10},color:"white"},modalConfig:{topOffset:-8}}},Vt=[{delay:2500,value:!0},{delay:3e3,value:!1},{delay:2500,value:!0},{delay:3e3,value:!1}],Be={x:0,y:0,width:0,height:0},ls="send-event",cs=1e3*60,hs=async()=>{try{const e=await fetch(a.API_ENDPOINTS.PILLARS,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});return e.ok?(await e.json()).data?.active_pillars||[]:[]}catch(e){throw new Error("SuperWeb SDK: Error fetching tabs",{cause:e})}},ds=async()=>{try{const e=await fetch(a.API_ENDPOINTS.ONBOARDING,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"});return e.ok?(await e.json())?.data?.items||[]:[]}catch(e){throw new Error("SuperWeb SDK: Error fetching onboarding data",{cause:e})}},ps=e=>{typeof window>"u"||window.dispatchEvent(new CustomEvent(ls,{detail:e,bubbles:!0,composed:!0}))},mt=({state:e,isScrolled:t})=>{const i=a.TABULAR_HEIGHT.FULL,s=a.TABULAR_HEIGHT.COMPACT,r=e==="hidden"?0:e==="full"&&!t?i:s,n=e==="hidden"?e:e==="full"&&!t?"full":"compact";window.SuperWebSDK&&(window.SuperWebSDK.navigationTabState={variant:n,height:r}),window.dispatchEvent(new CustomEvent("superWebNavigationTabState",{detail:{variant:n,height:r}}))},us=e=>{const t=e.pushState,i=e.replaceState;function s(r){window.dispatchEvent(new Event(r))}e.pushState=function(...r){t.apply(e,r),s("pushstate"),s("locationchange")},e.replaceState=function(...r){i.apply(e,r),s("replacestate"),s("locationchange")},window.addEventListener("popstate",()=>s("locationchange"))},fs=e=>{let t=window.location.origin+window.location.pathname;const i=()=>{const r=window.location.origin+window.location.pathname;r!==t&&(t=r,e())},s=window?.next?.router;return s?.events?(s.events.on("routeChangeComplete",i),()=>{s.events.off("routeChangeComplete",i)}):(us(window.history),window.addEventListener("locationchange",i),()=>{window.removeEventListener("locationchange",i)})},Rt=()=>{const e=window.location.pathname;return e==="/"?"/":`/${e.replace(/^\/|\/$/g,"")}/`},gs=()=>new URLSearchParams(location.search),Ge=e=>gs().get(e),Ke=()=>{const e=Ge(a.QUERY_PARAMS.UTM_SOURCE),t=Ge(a.QUERY_PARAMS.SUPERWEB_USER);return e!==null&&a.UTM_SOURCES.includes(e)||t!==null},ms=()=>{try{const e=new URL(document.referrer),t=e.searchParams.get(a.QUERY_PARAMS.UTM_SOURCE)||"",i=e.searchParams.get(a.QUERY_PARAMS.SUPERWEB_USER)||"";return a.UTM_SOURCES.includes(t)||!!i}catch{return!1}},bs=()=>{const e=new URL(window.location.href);e.searchParams.set(a.QUERY_PARAMS.SUPERWEB_USER,"true"),history.replaceState(window.history.state,"",e.toString())},_s=(e,t)=>{if(!e.endsWith("*"))return e===t;const i=e.slice(0,-1),s=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return(i.endsWith("/")?new RegExp(`^${s}(?:$|.*)`):new RegExp(`^${s}(?:$|/.*)`)).test(t)};function Ye(e,t){const i=Object.keys(t).find(s=>_s(s,e));return i?t[i]:"hidden"}const ws={isSuperWebUser(){return Ke()}},Qt=e=>btoa(encodeURIComponent(e)),je=(e,t)=>{let i=structuredClone(e);const s=a.HISTORY.MAX,r=a.HISTORY.MAX_BYTES,n=Object.entries(i);n.length>s&&(i=Object.fromEntries(n.slice(-s)));let o=Qt(JSON.stringify(i));for(;o.length>r&&Object.keys(i).length>0;){const p=Object.keys(i)[0];delete i[p],o=Qt(JSON.stringify(i))}return t.map(l=>{const p=new URL(l.web_url);let c=new URL(l.web_url);const d=structuredClone(i);d[l.name]&&(c=new URL(d[l.name]),delete d[l.name]);const b=Object.keys(d).length>=1?encodeURIComponent(Qt(JSON.stringify(d))):"";if(!b.length||p.origin!==c.origin)return l;if(c.origin.includes(a.HISTORY.REDIRECT_API)){const P=new URL(c.searchParams.get(a.QUERY_PARAMS.REDIRECT)??"",c.origin),E=new URLSearchParams(c.searchParams);return E.set(a.QUERY_PARAMS.REDIRECT,P.pathname),E.set(a.QUERY_PARAMS.UTM_SOURCE,a.UTM.SUPER_WEB),E.set(a.QUERY_PARAMS.HISTORY,b),c.search=E.toString()?`?${E.toString()}`:"",{...l,web_url:c.href}}return c.searchParams.set(a.QUERY_PARAMS.HISTORY,b),c.searchParams.set(a.QUERY_PARAMS.SUPERWEB_USER,"true"),{...l,web_url:c.href}})},vs=({currentHistory:e,currentPillarName:t,pillars:i,currentUrl:s,apiPillars:r})=>{const n=window.location.origin,o=new URL(s,n);if(!o||(o.searchParams.delete(a.QUERY_PARAMS.TOKEN),!i?.length||!t||!r?.length))return!1;const h=o.pathname===a.UNITS_PILLAR.path?a.UNITS_PILLAR.name:t,l=i.find(E=>E.name===h),p=r.find(E=>E.name===t);if(!l||!p)return!1;let c=new URL(l.web_url);const d=c.hostname.includes(new URL(Ft.PROD).hostname)||c.hostname.includes(new URL(Ft.DEMO).hostname);d?c.searchParams.set(a.QUERY_PARAMS.REDIRECT,`${o.pathname}${o.search}`):c=new URL(o,c.origin);const b=structuredClone(e||{});return b[h]===c.href?!1:(c.href===new URL(p.web_url).href?delete b[h]:b[h]=d?`${c.origin}${c.pathname}?${a.QUERY_PARAMS.REDIRECT}=${o.pathname!=="/"?o.pathname.replace("/",""):o.pathname}${o.searchParams.size>0&&`&${o.searchParams.toString()}`}`:c.href,{pillars:je(b,i),history:b})},ze=e=>(e===document.body||e===document.documentElement?window.scrollY:e.scrollTop)||window.scrollY;function Ss(e,t){return t===a.DIGIKALA_PILLAR.name&&e!==document?!1:e===document.body||e===document.documentElement||e===document?!0:ys(e)}function ys(e){if(!e)return!1;const t=50;try{return e.clientHeight+t>=document.documentElement.clientHeight*.7}catch{return!1}}class Jt{constructor(t="local",i=a.NAME_SPACE,s){this.storage=t==="local"?localStorage:sessionStorage,this.prefix=i?`${i}`:"",this.defaultTTLMs=typeof s=="number"?s:null,this.clear(a.OLD_NAME_SPACE)}key(t){return`${this.prefix}${t}`}nowMs(){return Date.now()}envelopeFor(t,i){const s=typeof i=="number"?i:this.defaultTTLMs??null;return{value:t,expires:s?this.nowMs()+s:null}}get(t,i=null){try{const s=this.storage.getItem(this.key(t));if(s===null)return i;const r=JSON.parse(s);if(r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"expires")){const n=r.expires;return typeof n=="number"&&n<this.nowMs()?(this.remove(t),i):r.value}return r}catch(s){return console.error("[Storage] Failed to get:",t,s),i}}set(t,i,s){try{const r=this.envelopeFor(i,s);this.storage.setItem(this.key(t),JSON.stringify(r))}catch(r){console.error("[Storage] Failed to set:",t,r)}}remove(t){try{this.storage.removeItem(this.key(t))}catch(i){console.error("[Storage] Failed to remove:",t,i)}}clear(t){const i=[];for(let s=0;s<this.storage.length;s++){const r=this.storage.key(s);r?.startsWith(t||this.prefix)&&i.push(r)}i.forEach(s=>this.storage.removeItem(s))}purgeExpired(){const t=[];for(let i=0;i<this.storage.length;i++){const s=this.storage.key(i);s?.startsWith(this.prefix)&&t.push(s)}for(const i of t)try{const s=this.storage.getItem(i);if(!s)continue;const r=JSON.parse(s);if(r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"expires")){const n=r.expires;typeof n=="number"&&n<this.nowMs()&&this.storage.removeItem(i)}}catch{}}}const I=new Jt("local",a.NAME_SPACE,null),Tt=new Jt("session",a.NAME_SPACE),bt=new Jt("local",a.NAME_SPACE,20*cs),Fe=()=>{Tt.set(a.NEW_STORAGE_KEYS.SUPERWEB_USER,"true")},$s=()=>Tt.get(a.NEW_STORAGE_KEYS.SUPERWEB_USER)==="true";const qe={ATTRIBUTE:1},Ve=e=>(...t)=>({_$litDirective$:e,values:t});let Qe=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,i,s){this._$Ct=t,this._$AM=i,this._$Ci=s}_$AS(t,i){return this.update(t,i)}update(t,i){return this.render(...i)}};const it=Ve(class extends Qe{constructor(e){if(super(e),e.type!==qe.ATTRIBUTE||e.name!=="class"||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){if(this.st===void 0){this.st=new Set,e.strings!==void 0&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((s=>s!==""))));for(const s in t)t[s]&&!this.nt?.has(s)&&this.st.add(s);return this.render(t)}const i=e.element.classList;for(const s of this.st)s in t||(i.remove(s),this.st.delete(s));for(const s in t){const r=!!t[s];r===this.st.has(s)||this.nt?.has(s)||(r?(i.add(s),this.st.add(s)):(i.remove(s),this.st.delete(s)))}return B}}),L=Ii`:host{display:block}.superweb-tab{flex:1;min-width:68px}*{box-sizing:border-box;overscroll-behavior:none}html,body{margin:0;padding:0;overscroll-behavior:none}.superweb-tabs-container{max-width:100vw;scrollbar-width:none;-ms-overflow-style:none;position:relative;width:100%;overflow-y:hidden;overflow-x:auto}.superweb-tabs-container.full{height:82px}.superweb-tabs-container.compact{height:48px}.superweb-tabs-container.skeleton .superweb-tabs-navigation{height:100%}.superweb-tabs-container::-webkit-scrollbar{display:none}.superweb-tabs-navigation{display:flex;gap:8px;padding:8px 16px;width:max-content;overflow-x:auto;min-width:100%;direction:rtl;position:absolute;overflow-y:visible;z-index:100}.superweb-tab-item.full{cursor:pointer;display:flex;align-items:center;flex-direction:column;text-decoration:none;min-width:68px;max-height:66px;flex:1 1 0;flex:1}.superweb-tab-item.full .superweb-tab-padding-top{max-height:8px;min-height:8px;width:100%;border-top-left-radius:8px;border-top-right-radius:8px}.superweb-tab-item.full .superweb-tab-icon-wrapper{width:100%;text-align:center;transition:transform .3s;transform-origin:top;max-height:34px;min-height:34px}.superweb-tab-item.full .superweb-tab-icon{transition:transform .2s;transform:scale(1);transform-origin:top;object-fit:contain}.superweb-tab-item.full .superweb-tab-title{padding-bottom:8px;width:100%;transition:transform .3s;border-bottom-left-radius:8px;border-bottom-right-radius:8px;text-align:center;font-size:11px;font-weight:500;height:24px}.superweb-tab-item.full.scrolled .superweb-tab-icon-wrapper{transform:scaleY(0);max-height:unset;min-height:0}.superweb-tab-item.full.scrolled .superweb-tab-icon{transform:scale(0)}.superweb-tab-item.full.scrolled .superweb-tab-title{transform:translateY(-34px)}.superweb-tab-item.full:not(.active) .superweb-tab-padding-top{border:1px solid #e0e0e0;border-bottom:none}.superweb-tab-item.full:not(.active) .superweb-tab-icon-wrapper{border:1px solid #e0e0e0;border-top:none;border-bottom:none}.superweb-tab-item.full:not(.active) .superweb-tab-title{border-bottom-left-radius:8px;border-bottom-right-radius:8px;border:1px solid #e0e0e0;border-top:none}.superweb-tab-item.compact{cursor:pointer;display:flex;align-items:center;justify-content:center;gap:4px;padding:8px 6px;min-width:68px;text-decoration:none;border-radius:8px;height:30px;border:1px solid #e0e0e0;contain:layout style;overflow:hidden;flex:1 1 0}.superweb-tab-item.compact .superweb-tab-title{font-size:12px;font-weight:400;line-height:2.15;margin-top:2px;white-space:nowrap}.superweb-tab-item.compact .superweb-tab-icon-wrapper{height:24px}.superweb-tab-item.compact.active{border:none}.superweb-tab-item.active{cursor:default}.superweb-tab-item:not(.active).compact{background-color:#fff}.superweb-tab-item:not(.active) .superweb-tab-title,.superweb-tab-item:not(.active) .superweb-tab-icon-wrapper,.superweb-tab-item:not(.active) .superweb-tab-padding-top{background-color:#fff}.superweb-tab-item:not(.active) .superweb-tab-padding-top{box-shadow:0 1px #fff}.superweb-tab-item:not(.active) .superweb-tab-title{position:relative}.superweb-tab-item:not(.active) .superweb-tab-title:before{content:\"\";position:absolute;width:100%;height:3px;left:0;right:0;top:-1px;background-color:#fff;z-index:0}.animated-badge-container{position:relative;display:inline-block;overflow:hidden;white-space:nowrap;height:24px;width:100%}.animated-badge-container .animated-badge-text{position:absolute;left:0;right:0;transform:translateY(26px);width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;animation-duration:.25s;animation-fill-mode:forwards;animation-timing-function:ease-out}.animated-badge-container .animated-badge-text.visible{transform:translateY(1px);animation:none}.animated-badge-container .animated-badge-text.entering{animation-name:badge-slide-in}.animated-badge-container .animated-badge-text.exiting{animation-name:badge-slide-out}.animated-badge-container .animated-altering-text{border-radius:4px;width:calc(100% - 8px);margin:0 auto}@keyframes badge-slide-in{0%{transform:translateY(26px)}to{transform:translateY(1px)}}@keyframes badge-slide-out{0%{transform:translateY(1px)}to{transform:translateY(-26px)}}.spotlight-overlay{position:fixed;inset:0;z-index:1000;height:100vh}.spotlight-modal-content{position:absolute;width:100%;z-index:1001}.spotlight-outline{position:absolute;pointer-events:none;z-index:1002}.superweb-modal{padding-inline:8px}.superweb-modal-header{display:flex;align-items:center;gap:8px;margin-top:12px;margin-bottom:8px}.superweb-modal-badge{background-color:#ef4056;color:#fff;padding:2px 6px 4px;border-radius:999px;font-size:11px;font-weight:500}.superweb-modal-content{background-color:#fff;border-radius:8px;padding:16px}.superweb-modal-image-container{width:100%;position:relative;border-radius:8px}.superweb-modal-image{width:100%;object-fit:contain;border-radius:8px;position:absolute}.superweb-modal-title{font-size:14px;font-weight:700;color:#1f1f1f;line-height:1.8}.superweb-modal-description{font-size:12px;font-weight:400;color:#1f1f1f;line-height:1.8;margin:0 0 8px}.superweb-modal-buttons{display:flex;gap:8px;padding-top:12px}.superweb-modal-button{outline:none;border:none;height:48px;border-radius:8px;font-family:inherit;font-weight:500;font-size:14px;flex:1;cursor:pointer}.superweb-modal-primary-button{color:#fff}.superweb-modal-secondary-button{color:#333;background-color:#ecedef}.superweb-modal-icon{width:24px;height:24px}`;var Es=Object.getOwnPropertyDescriptor,As=(e,t,i,s)=>{for(var r=s>1?void 0:s?Es(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=o(r)||r);return r};let Xt=class extends O{render(){return f`<div class="superweb-tab-item" role="tab" aria-label="Loading tab"></div>`}};Xt.styles=[L],Xt=As([G("skeleton-tab")],Xt);var Ps=Object.defineProperty,Rs=Object.getOwnPropertyDescriptor,Je=e=>{throw TypeError(e)},Xe=(e,t,i,s)=>{for(var r=s>1?void 0:s?Rs(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&Ps(t,i,r),r},Ts=(e,t,i)=>t.has(e)||Je("Cannot "+i),Os=(e,t,i)=>t.has(e)?Je("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Cs=(e,t,i)=>(Ts(e,t,"access private method"),i),Zt,Ze;let Ot=class extends O{constructor(){super(...arguments),Os(this,Zt),this.currentPillarName=null}render(){const t=Cs(this,Zt,Ze).call(this),i=it({"superweb-tabs-container":!0,skeleton:!0,[t]:!0});return f`<div class="${i}" role="tablist" aria-label="SuperWeb navigation loading isHere"><nav class="superweb-tabs-navigation" aria-label="Super web navigation">${Array.from({length:a.SKELETON_TABS_COUNT}).map(()=>f`<skeleton-tab></skeleton-tab>`)}</nav></div>`}};Zt=new WeakSet,Ze=function(){const e=I.get(a.NEW_STORAGE_KEYS.PAGE_STATES);if(!e||!this.currentPillarName)return"hidden";try{const i=e[this.currentPillarName],s=Rt();return Ye(s,i)}catch{return"hidden"}},Ot.styles=[L],Xe([g({type:String,attribute:"current-pillar-name"})],Ot.prototype,"currentPillarName",2),Ot=Xe([G("navigation-skeleton")],Ot);function*xs(e,t){if(e!==void 0){let i=0;for(const s of e)yield t(s,i++)}}const ks=()=>{let e=!1;return(function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([\- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([\- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[23]|n30(0|2)|n50([025])|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8c]))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([\-01])|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4)))&&(e=!0)})(navigator.userAgent),e},Ls=window.matchMedia("(display-mode: standalone)").matches;class Us{constructor(){this.intrackBlocking=!1,this.requestRunning=!1,this.queued=[],window.addEventListener("dk:intrack:modal-will-show",t=>{this.intrackBlocking=!!t.detail?.willShow,this.flush()}),window.addEventListener("dk:intrack:modal-closed",()=>{this.intrackBlocking=!1,this.flush()})}request(t){this.queued.push(t),this.flush()}async flush(){if(this.intrackBlocking||this.requestRunning)return;const t=this.queued.shift();if(t){this.requestRunning=!0;try{await t()}finally{this.requestRunning=!1,this.flush()}}}}const te="__dk_modal_coordinator__";function Ms(){const e=window;return e[te]||(e[te]=new Us),e[te]}var Ns=Object.defineProperty,Is=Object.getOwnPropertyDescriptor,ti=e=>{throw TypeError(e)},ei=(e,t,i,s)=>{for(var r=s>1?void 0:s?Is(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&Ns(t,i,r),r},ii=(e,t,i)=>t.has(e)||ti("Cannot "+i),Ws=(e,t,i)=>(ii(e,t,"read from private field"),i?i.call(e):t.get(e)),si=(e,t,i)=>t.has(e)?ti("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Ds=(e,t,i)=>(ii(e,t,"access private method"),i),ee,ri,ie;let Ct=class extends O{constructor(){super(...arguments),si(this,ee),this.pillarData=null,si(this,ie,()=>{this.dispatchEvent(new CustomEvent("send-event",{detail:{action:"close"},bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent("close"))})}firstUpdated(e){if(super.firstUpdated(e),!this.pillarData?.id)return;this.dispatchEvent(new CustomEvent("send-event",{detail:{action:"view"},bubbles:!0,composed:!0}));const t=I.get(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS),i=JSON.parse(t||"{}");i[this.pillarData?.id]=(i[this.pillarData?.id]||0)+1,I.set(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS,JSON.stringify(i))}render(){if(!this.pillarData)return u;const{title:e="",description:t="",badge_text:i,image:s,action:r,icon:n,image_ratio:o}=this.pillarData,h=s?.url,l=r?.title,p=r?.url,c=r?.background_color;return f`<div class="superweb-modal"><div class="superweb-modal-content">${h?f`<div class="superweb-modal-image-container" style="${o?`aspect-ratio: ${o}`:""}"><img class="superweb-modal-image" src="${h}" alt="${e}"></div>`:u}<div class="superweb-modal-header">${n?.url?f`<img class="superweb-modal-icon" src="${n.url}" alt="${e}">`:u} <span class="superweb-modal-title">${e}</span> ${i?f`<span class="superweb-modal-badge">${i}</span>`:u}</div>${t?f`<p class="superweb-modal-description">${t}</p>`:u}<div class="superweb-modal-buttons">${p?f`<button class="superweb-modal-button superweb-modal-primary-button" style="${`background-color: ${c};`}" @click="${()=>Ds(this,ee,ri).call(this,p)}">${l}</button>`:u} <button class="superweb-modal-button superweb-modal-secondary-button" @click="${Ws(this,ie)}">متوجه شدم</button></div></div></div>`}};ee=new WeakSet,ri=function(e){if(!this.pillarData?.id)return;const t=I.get(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS),i=JSON.parse(t||"{}");i[this.pillarData.id]=this.pillarData.number_of_view,I.set(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS,JSON.stringify({...i})),this.dispatchEvent(new CustomEvent("send-event",{detail:{action:"main"},bubbles:!0,composed:!0})),e&&(window.location.href=e),this.dispatchEvent(new CustomEvent("close"))},ie=new WeakMap,Ct.styles=[L],ei([g({type:Object,attribute:!1})],Ct.prototype,"pillarData",2),Ct=ei([G("onboarding-modal")],Ct);const ni="important",Hs=" !"+ni,W=Ve(class extends Qe{constructor(e){if(super(e),e.type!==qe.ATTRIBUTE||e.name!=="style"||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,i)=>{const s=e[i];return s==null?t:t+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${s};`}),"")}update(e,[t]){const{style:i}=e.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(t)),this.render(t);for(const s of this.ft)t[s]==null&&(this.ft.delete(s),s.includes("-")?i.removeProperty(s):i[s]=null);for(const s in t){const r=t[s];if(r!=null){this.ft.add(s);const n=typeof r=="string"&&r.endsWith(Hs);s.includes("-")||n?i.setProperty(s,n?r.slice(0,-11):r,n?ni:""):i[s]=r}}return B}});var Bs=Object.defineProperty,Gs=Object.getOwnPropertyDescriptor,oi=e=>{throw TypeError(e)},xt=(e,t,i,s)=>{for(var r=s>1?void 0:s?Gs(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&Bs(t,i,r),r},se=(e,t,i)=>t.has(e)||oi("Cannot "+i),y=(e,t,i)=>(se(e,t,"read from private field"),t.get(e)),st=(e,t,i)=>t.has(e)?oi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),ai=(e,t,i,s)=>(se(e,t,"write to private field"),t.set(e,i),i),_=(e,t,i)=>(se(e,t,"access private method"),i),R,re,rt,m,li,ne,oe,ae,ci,hi,di,pi,le,_t,ui,wt,fi,ce,he,gi;let nt=class extends O{constructor(){super(...arguments),st(this,m),st(this,R,null),st(this,re,Array.isArray(L)?L.map(e=>e?.cssText??"").filter(Boolean).join(`
`):L?.cssText??""),this.props={},this.isOpen=!1,this.targetPosition=Be,this.previousBodyOverflow=null,this.previousDocumentOverflow=null,this.positionMonitorId=null,this.lastRect=null,st(this,rt,()=>{this.isOpen&&_(this,m,ae).call(this)}),st(this,ne,e=>{e.stopPropagation()}),st(this,oe,e=>{e.target===e.currentTarget&&this.close()})}connectedCallback(){super.connectedCallback(),typeof window<"u"&&(window.addEventListener("resize",y(this,rt)),window.addEventListener("scroll",y(this,rt),!0))}disconnectedCallback(){typeof window<"u"&&(window.removeEventListener("resize",y(this,rt)),window.removeEventListener("scroll",y(this,rt),!0)),_(this,m,_t).call(this),_(this,m,ce).call(this),super.disconnectedCallback()}async updated(e){if(e.has("isOpen")&&_(this,m,fi).call(this),!this.isOpen){_(this,m,wt).call(this),_(this,m,_t).call(this);return}_(this,m,ui).call(this),_(this,m,le).call(this)}close(){return this.isOpen?(this.dispatchEvent(new CustomEvent("send-event",{detail:{action:"close"},bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent("close")),this.isOpen=!1,_(this,m,wt).call(this),_(this,m,_t).call(this),this.props.onClose?.(),this):this}render(){return u}};R=new WeakMap,re=new WeakMap,rt=new WeakMap,m=new WeakSet,li=function(){const e=this.props.renderContent?.();return e||f`<slot></slot>`},ne=new WeakMap,oe=new WeakMap,ae=function(){const e=_(this,m,ci).call(this);this.lastRect=this.props.spotlightElement?.getBoundingClientRect()??null,(e.x!==this.targetPosition.x||e.y!==this.targetPosition.y||e.width!==this.targetPosition.width||e.height!==this.targetPosition.height)&&(this.targetPosition=e)},ci=function(){if(!this.props.spotlightElement||typeof window>"u"||typeof document>"u")return Be;const e=this.props.spotlightElement.getBoundingClientRect(),t=_(this,m,he).call(this).padding;return{x:e.left-t,y:e.top-t,width:e.width+t*2,height:e.height+t}},hi=function(e){return`${e.topLeft}px ${e.topRight}px ${e.bottomRight}px ${e.bottomLeft}px`},di=function(e){if(typeof window>"u")return;const t=window.innerWidth,i=window.innerHeight,{x:s,y:r,width:n,height:o}=this.targetPosition;return`path(evenodd,'M 0 0 L 0 ${i} L ${t} ${i} L ${t} 0 Z M ${s+e.topLeft} ${r} L ${s+n-e.topRight} ${r} Q ${s+n} ${r} ${s+n} ${r+e.topRight} L ${s+n} ${r+o-e.bottomRight} Q ${s+n} ${r+o} ${s+n-e.bottomRight} ${r+o} L ${s+e.bottomLeft} ${r+o} Q ${s} ${r+o} ${s} ${r+o-e.bottomLeft} L ${s} ${r+e.topLeft} Q ${s} ${r} ${s+e.topLeft} ${r} Z')`},pi=function(){if(!this.isOpen||!this.props.spotlightElement)return u;const e=_(this,m,he).call(this),t={backgroundColor:this.props.overlayConfig.color,clipPath:_(this,m,di).call(this,e.radius)},i={top:`${this.targetPosition.y-e.outlineWidth}px`,left:`${this.targetPosition.x-e.outlineWidth}px`,width:`${this.targetPosition.width+e.outlineWidth*2}px`,height:`${this.targetPosition.height+e.outlineWidth*2}px`,backgroundColor:e.color,borderRadius:_(this,m,hi).call(this,e.radius)},r={top:`${this.targetPosition.y+this.targetPosition.height+e.outlineWidth+this.props.modalConfig.topOffset+e.padding}px`,zIndex:"9999",maxWidth:window.innerWidth>500?"calc(100vw - 20vw)":"unset",left:window.innerWidth>500?"50%":"unset",transform:window.innerWidth>500?"translateX(-50%)":"unset"};return f`<style>${y(this,re)}</style><div class="spotlight-overlay" data-spotlight-modal-container style="${W(t)}" @click="${y(this,oe)}"><div class="spotlight-outline" style="${W(i)}"></div><div class="spotlight-modal-content" style="${W(r)}" @click="${y(this,ne)}">${_(this,m,li).call(this)}</div></div>`},le=function(){if(!y(this,R)){if(typeof document>"u")return;ai(this,R,document.createElement("div")),y(this,R).setAttribute("data-spotlight-portal",""),y(this,R).style.contain="unset",document.body.appendChild(y(this,R))}if(y(this,R)){if(!this.isOpen){Pt(u,y(this,R)),_(this,m,_t).call(this);return}Pt(_(this,m,pi).call(this),y(this,R))}},_t=function(){y(this,R)&&(Pt(u,y(this,R)),y(this,R).remove(),ai(this,R,null),this.isOpen=!1)},ui=function(){if(_(this,m,wt).call(this),!this.isOpen||!this.props.spotlightElement)return;const e=()=>{if(!this.isOpen||!this.props.spotlightElement){_(this,m,wt).call(this);return}const t=this.props.spotlightElement.getBoundingClientRect();(!this.lastRect||t.top!==this.lastRect.top||t.left!==this.lastRect.left||t.width!==this.lastRect.width||t.height!==this.lastRect.height)&&(this.lastRect=t,_(this,m,ae).call(this),_(this,m,le).call(this)),this.positionMonitorId=requestAnimationFrame(e)};this.positionMonitorId=requestAnimationFrame(e)},wt=function(){this.positionMonitorId!==null&&(cancelAnimationFrame(this.positionMonitorId),this.positionMonitorId=null),this.lastRect=null},fi=function(){typeof document>"u"||(this.isOpen?(this.previousBodyOverflow=document.body.style.overflow,this.previousDocumentOverflow=document.documentElement.style.overflow,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"):_(this,m,ce).call(this))},ce=function(){typeof document>"u"||(this.previousBodyOverflow!==null&&(document.body.style.overflow=this.previousBodyOverflow,this.previousBodyOverflow=null),this.previousDocumentOverflow!==null&&(document.documentElement.style.overflow=this.previousDocumentOverflow,this.previousDocumentOverflow=null))},he=function(){return{...this.props.spotlightConfig,radius:_(this,m,gi).call(this,this.props.spotlightConfig?.radius)}},gi=function(e){return{topLeft:Math.max(0,e.topLeft??0),topRight:Math.max(0,e.topRight??0),bottomRight:Math.max(0,e.bottomRight??0),bottomLeft:Math.max(0,e.bottomLeft??0)}},nt.styles=L,xt([g({type:Object,attribute:!1})],nt.prototype,"props",2),xt([g({attribute:!1,reflect:!0,converter:{fromAttribute(e){return e?JSON.parse(e):!1}}})],nt.prototype,"isOpen",2),xt([N()],nt.prototype,"targetPosition",2),nt=xt([G("spotlight-element")],nt);const mi="speculation-rules",Ks="speculationrules",Ys=["cors.","api."],js=e=>{try{return new URL(e,location.origin)}catch{return console.error("Invalid URL for speculation rule:",e),null}},zs=e=>Ys.some(t=>e.includes(t)),Fs=e=>{const t=document.getElementById(e);if(!t)return{};try{return t.textContent&&JSON.parse(t.textContent)||{}}catch(i){return console.error("Failed to parse existing speculation rules:",i),{}}},qs=(e,t)=>{const i=document.createElement("script");i.id=e,i.type=Ks,i.textContent=JSON.stringify(t,null,2);const s=document.getElementById(e);s&&s.parentNode&&s.parentNode.removeChild(s),document.head.appendChild(i)},Vs=(e,t)=>{e[t]=e[t]||[{source:"list",urls:[]}];const i=e[t];let s=i.find(r=>r.source==="list")||i[0];return s||(s={source:"list",urls:[]},i.push(s)),s.urls=s.urls||[],s},Qs=e=>{const t=e.startsWith("http")?new URL(e).origin:e;if(!document.querySelector(`link[rel="dns-prefetch"][href="${t}"]`)){const i=document.createElement("link");i.rel="dns-prefetch",i.href=t,document.head.appendChild(i)}if(!document.querySelector(`link[rel="preconnect"][href="${t}"]`)){const i=document.createElement("link");i.rel="preconnect",i.href=t,i.crossOrigin="anonymous",document.head.appendChild(i)}};function Js(e){if(!e)return;const t=js(e);if(!t||zs(t.hostname))return;const i=t.origin===location.origin,s=i?"prerender":"prefetch",r="eager",n=Fs(mi),o=Vs(n,s);o.eagerness||(o.eagerness=r),o.urls.includes(e)||o.urls.push(e),qs(mi,n),i||Qs(t.origin)}var Xs=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,bi=e=>{throw TypeError(e)},C=(e,t,i,s)=>{for(var r=s>1?void 0:s?Zs(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&Xs(t,i,r),r},de=(e,t,i)=>t.has(e)||bi("Cannot "+i),q=(e,t,i)=>(de(e,t,"read from private field"),t.get(e)),kt=(e,t,i)=>t.has(e)?bi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),V=(e,t,i,s)=>(de(e,t,"write to private field"),t.set(e,i),i),ot=(e,t,i)=>(de(e,t,"access private method"),i),tr=(e,t,i,s)=>({set _(r){V(e,t,r)},get _(){return q(e,t)}}),at,Q,lt,K,pe,ue,fe;let T=class extends O{constructor(){super(...arguments),kt(this,K),this.text="",this.badgeTextColor="",this.badgeBackgroundColor="",this.badgeText="",this.textColor="",this.backgroundColor="",this.variant="full",this.isActive=!1,this.isScrolled=!1,this.showAltering=!1,this.hasStarted=!1,kt(this,at,0),kt(this,Q,null),kt(this,lt,!1)}connectedCallback(){super.connectedCallback(),this.isScrolled||ot(this,K,pe).call(this)}disconnectedCallback(){super.disconnectedCallback(),ot(this,K,fe).call(this)}updated(e){e.has("isScrolled")&&(this.isScrolled?(ot(this,K,fe).call(this),this.showAltering=!1):ot(this,K,pe).call(this))}render(){const e=W({backgroundColor:this.badgeBackgroundColor,color:this.badgeTextColor}),t=W({color:this.textColor,backgroundColor:this.backgroundColor,boxShadow:this.variant==="full"&&this.isActive&&this.backgroundColor?`0 -1px ${this.backgroundColor}`:""}),i=this.hasStarted?`animated-badge-text ${this.showAltering?"exiting":"entering"}`:"animated-badge-text visible",s=this.hasStarted?`animated-badge-text animated-altering-text ${this.showAltering?"entering":"exiting"}`:"animated-badge-text animated-altering-text";return f`<div class="animated-badge-container"><span class="${i}" style="${t}">${this.text} </span><span class="${s}" style="${e}">${this.badgeText}</span></div>`}};at=new WeakMap,Q=new WeakMap,lt=new WeakMap,K=new WeakSet,pe=function(){q(this,lt)||q(this,at)>=Vt.length||this.isScrolled||(V(this,lt,!0),ot(this,K,ue).call(this))},ue=function(){if(q(this,at)>=Vt.length||this.isScrolled){V(this,lt,!1),V(this,Q,null);return}const e=Vt[q(this,at)];V(this,Q,window.setTimeout(()=>{this.hasStarted=!0,this.showAltering=e.value,tr(this,at)._++,this.requestUpdate(),ot(this,K,ue).call(this)},e.delay))},fe=function(){q(this,Q)!==null&&(clearTimeout(q(this,Q)),V(this,Q,null)),V(this,lt,!1),this.hasStarted=!1},T.styles=L,C([g({type:String,attribute:!1})],T.prototype,"text",2),C([g({type:String,attribute:!1})],T.prototype,"badgeTextColor",2),C([g({type:String,attribute:!1})],T.prototype,"badgeBackgroundColor",2),C([g({type:String,attribute:!1})],T.prototype,"badgeText",2),C([g({type:String,attribute:!1})],T.prototype,"textColor",2),C([g({type:String,attribute:!1})],T.prototype,"backgroundColor",2),C([g({type:String,attribute:!1})],T.prototype,"variant",2),C([g({type:Boolean,attribute:!1})],T.prototype,"isActive",2),C([g({type:Boolean,attribute:!1})],T.prototype,"isScrolled",2),C([N()],T.prototype,"showAltering",2),C([N()],T.prototype,"hasStarted",2),T=C([G("animated-badge")],T);var er=Object.defineProperty,ir=Object.getOwnPropertyDescriptor,vt=(e,t,i,s)=>{for(var r=s>1?void 0:s?ir(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&er(t,i,r),r};let J=class extends O{constructor(){super(...arguments),this.data={},this.variant="full",this.currentPillarName="",this.isScrolled=!1}emitSelect(e){this.data&&this.dispatchEvent(new CustomEvent("tab-select",{detail:{pillarName:this.data.name,isActive:e},bubbles:!0,composed:!0}))}get isActive(){const e=this.data;if(!e)return!1;const t=Rt(),i=this.currentPillarName===a.DIGIKALA_PILLAR.name,s=e.name===a.UNITS_PILLAR.name,r=t===a.UNITS_PILLAR.path,n=e.name===a.BLACK_FRIDAY_PILLAR.name,o=t===a.BLACK_FRIDAY_PILLAR.path,h=e.name===this.currentPillarName;return n&&o&&i||s&&r&&i||h&&(!r&&!o||!i)}get targetUrl(){let e="";try{const t=new URL(this.data.web_url);let i=t.searchParams.get("utm-source");i&&(i=i+(Ls?"-pwa":""),t.searchParams.set("utm-source",i)),e=t.toString()}catch{e=this.data.web_url}return e}firstUpdated(){this.isActive||Js(this.targetUrl)}render(){const e=this.data;if(!e)return u;const t=this.variant||"full",i=this.isActive?e.background_color:void 0,s=this.isActive?e.focused_text_color:e.text_color,r=this.isActive&&e?.focused_image?.url?.[0]?e?.focused_image?.url?.[0]:e?.image?.url?.[0],n=it({"superweb-tab-icon":!0,[t]:!0,scrolled:this.isScrolled}),o=it({"superweb-tab-icon-wrapper":!0,[t]:!0}),h=W({backgroundColor:i||""}),l=it({"superweb-tab-title":!0,[t]:!0,scrolled:this.isScrolled}),p=W({color:s,backgroundColor:i||"",boxShadow:t==="full"&&this.isActive&&i?`0 -1px ${i}`:""}),c=W({backgroundColor:i||"",boxShadow:t==="full"&&this.isActive&&i?`0 1px ${i}`:""}),d=it({"superweb-tab-item":!0,active:this.isActive,[t]:!0,scrolled:this.isScrolled}),b=W({backgroundColor:t==="compact"&&i?i:void 0,color:t==="compact"&&i?s:void 0}),P=t!=="compact"&&r?f`<img class="${n}" width="32" height="32" src="${r}" alt="${e?.title||e.name}">`:u,E=f`<div class="${o}" style="${h}">${P}</div>`,Li=t==="full"&&e.badge_text&&!this.isActive,lr=Li?f`<animated-badge class="${l}" .text="${e.title}" .badgeText="${e.badge_text}" .badgeTextColor="${e.badge_text_color}" .badgeBackgroundColor="${e.badge_background_color}" .backgroundColor="${i}" .variant="${t}" .isActive="${this.isActive}" .textColor="${s}" .isScrolled="${this.isScrolled}"></animated-badge>`:u,cr=e?.title?f`<span class="${l}" style="${p}">${e.title}</span>`:u,Ui=Li?lr:cr,Mi=t==="full"?f`<div class="superweb-tab-padding-top" style="${c}"></div>${E} ${Ui}`:f`${E} ${Ui}`;return this.isActive?f`<div class="${d}" style="${b}" data-pillar="${e.name}" role="tab" aria-selected="true" aria-label="${e.title||e.name} - Current tab" @click="${()=>this.emitSelect(!0)}">${Mi}</div>`:f`<a class="${d}" href="${this.targetUrl}" data-pillar="${e.name}" role="tab" aria-selected="false" aria-label="${e.title||e.name} - Navigate to tab" @click="${()=>this.emitSelect(!1)}">${Mi}</a>`}};J.styles=[L],vt([g({type:Object,attribute:!1})],J.prototype,"data",2),vt([g({type:String})],J.prototype,"variant",2),vt([g({type:String,attribute:"current-pillar-name"})],J.prototype,"currentPillarName",2),vt([g({type:Boolean,attribute:"is-scrolled"})],J.prototype,"isScrolled",2),J=vt([G("superweb-tab")],J);var sr=Object.defineProperty,rr=Object.getOwnPropertyDescriptor,_i=e=>{throw TypeError(e)},U=(e,t,i,s)=>{for(var r=s>1?void 0:s?rr(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&sr(t,i,r),r},ge=(e,t,i)=>t.has(e)||_i("Cannot "+i),wi=(e,t,i)=>(ge(e,t,"read from private field"),i?i.call(e):t.get(e)),me=(e,t,i)=>t.has(e)?_i("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),nr=(e,t,i,s)=>(ge(e,t,"write to private field"),t.set(e,i),i),S=(e,t,i)=>(ge(e,t,"access private method"),i),be,w,vi,Si,yi,$i,Ei,_e,we,D,Ai,Lt;let x=class extends O{constructor(){super(),me(this,w),this.showModal="false",this.spotlightPillar=null,this.spotlightPillarElement=null,this.spotlightReady=!1,this.tabs=[],this.currentPillarName=null,this.isScrolled=!1,this.variant="full",me(this,be,!1),me(this,Lt,e=>{e.stopPropagation(),this.spotlightPillar&&this.dispatchEvent(new CustomEvent("send-event",{detail:{widgetName:"promotion-modal",clickedItemName:`${e.detail.action}_${this.spotlightPillar?.id}`},bubbles:!0,composed:!0}))}),this.modalCoordinator=Ms()}get shouldRenderSpotlight(){const e=Rt()==="/",t=this.currentPillarName===a.DIGIKALA_PILLAR.name;return e&&t&&this.showModal==="true"}updated(e){super.updated(e),(e.has("isScrolled")||e.has("variant")||e.has("tabs"))&&S(this,w,_e).call(this)}async firstUpdated(e){super.firstUpdated(e),S(this,w,_e).call(this),requestAnimationFrame(()=>{nr(this,be,!0)}),this.shouldRenderSpotlight?await S(this,w,Si).call(this):S(this,w,D).call(this,this.currentPillarName||"")}render(){const e=this.variant||"full",t=it({"superweb-tabs-container":!0,[e]:!0,scrolled:this.isScrolled});return f`<div class="${t}" role="tablist" aria-label="SuperWeb navigation" @tab-select="${S(this,w,yi)}"><nav class="superweb-tabs-navigation" aria-label="Super web navigation">${xs(this.tabs,i=>f`<superweb-tab class="superweb-tab" .data="${i}" .variant="${e}" current-pillar-name="${this.currentPillarName||""}" ?is-scrolled="${this.isScrolled}"></superweb-tab>`)}</nav></div>${this.shouldRenderSpotlight&&this.spotlightPillar&&this.spotlightReady?f`<spotlight-element @send-event="${wi(this,Lt)}" @close="${()=>{S(this,w,D).call(this,this.currentPillarName||"")}}" .isOpen="${this.spotlightPillar!==null}" .props="${{...a.SPOTLIGHT_MODAL,spotlightElement:this.spotlightPillarElement??null,renderContent:()=>f`<onboarding-modal @send-event="${wi(this,Lt)}" @close="${()=>{this.spotlightReady=!1,this.spotlightPillar=null,S(this,w,D).call(this,this.currentPillarName||"")}}" .pillarData="${this.spotlightPillar??null}"></onboarding-modal>`}}"></spotlight-element>`:u}`}};be=new WeakMap,w=new WeakSet,vi=function(e){this.spotlightPillar||(this.spotlightPillar=e,this.spotlightReady=!0)},Si=async function(){if(this.spotlightReady=!1,this.spotlightPillar=null,Tt.get(a.NEW_STORAGE_KEYS.SEEN_ONBOARDING_MODAL)===!0){S(this,w,D).call(this,this.currentPillarName||"");return}const t=await ds();if(t.length===0){S(this,w,D).call(this,this.currentPillarName||"");return}const i=I.get(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS);let s={};i?s=JSON.parse(i):I.set(a.NEW_STORAGE_KEYS.SPOTLIGHT_MODAL_VIEWS,"{}");let r=null;for(const n of t)if(n.number_of_view>(s?.[n.id]||0)){r=n,s?.[n.id]||(s[n.id]=0);break}if(!r){S(this,w,D).call(this,this.currentPillarName||"");return}if(this.spotlightPillarElement=await S(this,w,we).call(this,r.pillar_name)??null,!this.spotlightPillarElement){S(this,w,D).call(this,this.currentPillarName||"");return}Tt.set(a.NEW_STORAGE_KEYS.SEEN_ONBOARDING_MODAL,!0),this.modalCoordinator.request(async()=>{const{waitForScroll:n}=await S(this,w,D).call(this,r.pillar_name||"");n&&await S(this,w,Ai).call(this),S(this,w,vi).call(this,r)})},yi=function(e){const{pillarName:t,isActive:i}=e.detail;i||S(this,w,$i).call(this,t)},$i=function(e){if(e!==this.currentPillarName)try{const t=ks()?"mobile":"desktop",i={pillar:e,host:this.currentPillarName,client:t,ts:Date.now()};S(this,w,Ei).call(this,a.API_ENDPOINTS.TRACKING,i,t,!0)}catch(t){console.warn("SuperWeb SDK: Error in handleTabClick:",t)}},Ei=function(e,t,i,s=!0){try{const r=new URL(e,window.location.href);r.searchParams.set("client",i);const n=JSON.stringify(t);if(s&&typeof navigator<"u"&&"sendBeacon"in navigator&&navigator.sendBeacon(r.toString(),n))return;fetch(e,{method:"POST",body:n,headers:{"Content-Type":"application/json",Accept:"application/json","X-Web-Client":i},credentials:"include",keepalive:!0}).catch(o=>{console.warn("SuperWeb SDK: tracking request failed (keepalive fetch):",o)})}catch(r){console.warn("SuperWeb SDK: Error sending tracking data:",r)}},_e=function(){if(!this.containerEl)return;const e=a.TABULAR_HEIGHT.FULL,t=a.TABULAR_HEIGHT.COMPACT,s=this.variant==="full"&&!this.isScrolled?e:t,n=Number.parseInt(this.containerEl.style.height||"",10)||s,o=s;if(n===o){this.containerEl.style.height=`${o}px`;return}const h=200;function l(d){return d*d*(3-2*d)}const p=performance.now(),c=d=>{let b=Math.min((d-p)/h,1);b=l(b);const P=n+(o-n)*b;this.containerEl.style.height=`${P}px`,b<1&&requestAnimationFrame(c)};requestAnimationFrame(c)},we=async function(e){if(!e)return null;await this.updateComplete;const t=[...this.renderRoot.querySelectorAll("superweb-tab")];return t.length===0?null:(await Promise.all(t.map(i=>i.updateComplete)),t.map(i=>i.shadowRoot?.querySelector(`[data-pillar="${e}"]`)).find(i=>!!i)??null)},D=async function(e){if(!this.containerEl||!e)return Promise.resolve({waitForScroll:!1});const t=await S(this,w,we).call(this,e);if(!t||t.getBoundingClientRect().left>=this.containerEl.getBoundingClientRect().left&&t.getBoundingClientRect().right<=this.containerEl.getBoundingClientRect().right)return Promise.resolve({waitForScroll:!1});try{return t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"}),Promise.resolve({waitForScroll:!0})}catch{const s=this.containerEl.getBoundingClientRect(),r=t.getBoundingClientRect();if(r.left>=s.left&&r.right<=s.right)return Promise.resolve({waitForScroll:!1});const o=s.width,h=r.width,p=r.left-s.left+this.containerEl.scrollLeft-o/2+h/2;return this.containerEl.scrollTo({left:p,behavior:"smooth"}),Promise.resolve({waitForScroll:!0})}},Ai=async function(){return new Promise(e=>{if(!this.containerEl){e();return}const t=this.containerEl;let i,s,r,n;const o=()=>{t.removeEventListener("scrollend",r),t.removeEventListener("scroll",n),i&&clearTimeout(i),e()};r=()=>o(),n=()=>{s&&clearTimeout(s),s=window.setTimeout(()=>{o()},120)},"onscrollend"in t?t.addEventListener("scrollend",r,{once:!0}):t.addEventListener("scroll",n,{passive:!0}),i=window.setTimeout(()=>o(),700)})},Lt=new WeakMap,x.styles=[L],U([g({type:String,attribute:"show-modal"})],x.prototype,"showModal",2),U([N()],x.prototype,"spotlightPillar",2),U([N()],x.prototype,"spotlightPillarElement",2),U([N()],x.prototype,"spotlightReady",2),U([g({type:Array,attribute:!1})],x.prototype,"tabs",2),U([g({type:String,attribute:"current-pillar-name"})],x.prototype,"currentPillarName",2),U([g({type:Boolean,attribute:"is-scrolled"})],x.prototype,"isScrolled",2),U([g({type:String,attribute:"variant"})],x.prototype,"variant",2),U([as(".superweb-tabs-container")],x.prototype,"containerEl",2),x=U([G("navigation-tabs")],x);var or=Object.defineProperty,ar=Object.getOwnPropertyDescriptor,Pi=e=>{throw TypeError(e)},X=(e,t,i,s)=>{for(var r=s>1?void 0:s?ar(t,i):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(s?o(t,i,r):o(r))||r);return s&&r&&or(t,i,r),r},ve=(e,t,i)=>t.has(e)||Pi("Cannot "+i),v=(e,t,i)=>(ve(e,t,"read from private field"),i?i.call(e):t.get(e)),M=(e,t,i)=>t.has(e)?Pi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Ut=(e,t,i,s)=>(ve(e,t,"write to private field"),t.set(e,i),i),A=(e,t,i)=>(ve(e,t,"access private method"),i),ct,Mt,Nt,Y,Z,Ri,$,Ti,Oi,It,Ci,Se,Wt,Dt,ye,xi,$e,ki,Ee;return k.SuperWebTabsWidget=class extends O{constructor(){super(...arguments),M(this,$),this.currentPillarName=null,this.showModal=!1,this.tabs=null,this.isScrolled=!1,this.state="idle",M(this,ct,[]),M(this,Mt,!1),M(this,Nt,[]),M(this,Y),M(this,Z,null),M(this,Ri,t=>{const i=vs({currentHistory:v(this,Y),currentPillarName:this.currentPillarName,pillars:this.tabs,currentUrl:t,apiPillars:v(this,Z)});i&&(Ut(this,Y,i.history),bt.set(a.NEW_STORAGE_KEYS.TABS,i.pillars),bt.set(a.NEW_STORAGE_KEYS.HISTORY,i.history),this.tabs=i.pillars)}),M(this,It,t=>{if(A(this,$,Ci).call(this))return;const i=t instanceof HTMLElement?t:t.target;if(!Ss(i,this.currentPillarName))return;const s=ze(i);A(this,$,Se).call(this,s)}),M(this,ye,t=>{const i=bt.get(a.NEW_STORAGE_KEYS.HISTORY),s=v(this,Y)&&typeof v(this,Y)=="object"&&Object.keys(v(this,Y)).length?v(this,Y):i??{},r=je(s,t);return bt.set(a.NEW_STORAGE_KEYS.TABS,r),r}),M(this,$e,t=>{if(!v(this,Mt)){v(this,ct).push(t.detail);return}A(this,$,Ee).call(this,t.detail)})}firstUpdated(){if(!this.currentPillarName)throw new Error("SuperWeb SDK: pillar-name attribute is required")}connectedCallback(){super.connectedCallback(),document.addEventListener("scroll",v(this,It),{passive:!0,capture:!0}),requestAnimationFrame(async()=>{this.tabs=bt.get(a.NEW_STORAGE_KEYS.TABS),A(this,$,Wt).call(this),await A(this,$,Ti).call(this),A(this,$,Wt).call(this)}),typeof window<"u"&&(window.SuperWebSDK=ws)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("scroll",v(this,It),{capture:!0}),v(this,Nt)?.forEach(t=>{t()})}render(){if(this.state==="hidden")return f``;if(!this.tabs||this.tabs.length===0)return f`<navigation-skeleton current-pillar-name="${this.currentPillarName||""}"></navigation-skeleton>`;const t=this.state==="compact"?"compact":"full";return f`<navigation-tabs @send-event="${v(this,$e)}" .tabs="${this.tabs}" .showModal="${this.showModal}" current-pillar-name="${this.currentPillarName||""}" ?is-scrolled="${this.isScrolled}" .variant="${t}"></navigation-tabs>`}},ct=new WeakMap,Mt=new WeakMap,Nt=new WeakMap,Y=new WeakMap,Z=new WeakMap,Ri=new WeakMap,$=new WeakSet,Ti=async function(){try{const e=fs(()=>{A(this,$,Wt).call(this)});v(this,Nt).push(e),await A(this,$,Oi).call(this)}catch(e){throw new Error("SuperWeb SDK: Error initializing widget",{cause:e})}},Oi=async function(){try{if(Ke()){Fe(),await A(this,$,Dt).call(this);return}const e=ms(),t=$s();if(e||t){Fe(),bs(),await A(this,$,Dt).call(this);return}this.currentPillarName===a.DIGIKALA_PILLAR.name&&await A(this,$,Dt).call(this)}catch(e){throw new Error("SuperWeb SDK: Error detecting sources",{cause:e})}},It=new WeakMap,Ci=function(){return this.state==="hidden"||this.state==="idle"},Se=function(e,t){const i=t?.notify??!0;let s=this.isScrolled;this.isScrolled?e<a.IS_SCROLL_THRESHOLD_MIN&&(s=!1):e>a.IS_SCROLL_THRESHOLD_MAX&&(s=!0),this.isScrolled!==s&&(this.isScrolled=s,i&&mt({state:this.state,isScrolled:this.isScrolled}))},Wt=function(){if(!this.tabs||!this.currentPillarName){this.state="hidden",mt({state:"hidden",isScrolled:!1});return}const e=Rt(),t=this.tabs.find(n=>n.name===this.currentPillarName)?.pages_header_state||{},i=Ye(e,t);if(this.state=i||"hidden",this.state==="hidden"){mt({state:"hidden",isScrolled:!1});return}const s=document.documentElement||document.body,r=ze(s);A(this,$,Se).call(this,r,{notify:!1}),mt({state:this.state,isScrolled:this.isScrolled})},Dt=async function(){try{if(Ut(this,Z,await hs()),!v(this,Z).length){console.warn("SuperWeb SDK: No tabs available to render"),this.tabs=[],mt({state:"hidden",isScrolled:!1});return}this.tabs=v(this,ye).call(this,v(this,Z));const e=v(this,Z).reduce((t,i)=>(i.pages_header_state&&(t[i.name]=i.pages_header_state),t),{});I.set(a.NEW_STORAGE_KEYS.PAGE_STATES,e),I.remove(a.OLD_STORAGE_KEYS.PAGE_STATES),A(this,$,xi).call(this)}catch(e){throw new Error("SuperWeb SDK: Error loading navigation tabs",{cause:e})}},ye=new WeakMap,xi=function(){Ut(this,Mt,!0),window.dispatchEvent(new CustomEvent("superWebSDKReady")),A(this,$,ki).call(this)},$e=new WeakMap,ki=function(){if(v(this,ct).length===0)return;const e=[...v(this,ct)];Ut(this,ct,[]),e.forEach(t=>A(this,$,Ee).call(this,t))},Ee=function(e){if(this.sendEvent&&this.currentPillarName===a.DIGIKALA_PILLAR.name&&a.DIGIKALA_PILLAR.domains.some(t=>window.location.href.includes(t))){try{this.sendEvent(e)}catch(t){console.warn("SuperWeb SDK: sendEvent handler threw",t)}return}ps(e)},X([g({type:String,attribute:"pillar-name"})],k.SuperWebTabsWidget.prototype,"currentPillarName",2),X([g({attribute:"show-modal"})],k.SuperWebTabsWidget.prototype,"showModal",2),X([g({attribute:!1})],k.SuperWebTabsWidget.prototype,"sendEvent",2),X([N()],k.SuperWebTabsWidget.prototype,"tabs",2),X([N()],k.SuperWebTabsWidget.prototype,"isScrolled",2),X([N()],k.SuperWebTabsWidget.prototype,"state",2),k.SuperWebTabsWidget=X([G("superweb-tabs")],k.SuperWebTabsWidget),Object.defineProperty(k,Symbol.toStringTag,{value:"Module"}),k})({});
