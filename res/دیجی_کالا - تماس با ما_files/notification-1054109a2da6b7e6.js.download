(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1909],{83514:function(t,i,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/notification",function(){return e(96518)}])},96518:function(t,i,e){"use strict";e.r(i),e.d(i,{default:function(){return ii}});var n=e(2784),o=e(66383),a=e(52322),r=e(70423),c=e(5632),s=e(72610),l=e(27876),d=e(41218),u=e(88589),f=e(64665),m=e(45873),p=e(11559),g=e(72873),x=e(64177),T=e(53828),v=e(87049),N=e(8108),h=e(43287);function b(t){var i=t.widgetName,e=t.itemClickedName;(0,N.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:i,clicked_item_name:e}})}function C(t){b({widgetName:"first_open_notification",itemClickedName:t.notificationId})}function I(t){b({widgetName:"reopen_notification",itemClickedName:t.notificationId})}function E(t){b({widgetName:"read_all",itemClickedName:t.unreadNotificationCount})}function j(t){var i,e,n;e=(i={itemClickedName:t.tabTitle,widgetName:"notification_center_tabs"}).widgetName,n=i.itemClickedName,(0,N.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:e,clicked_item_name:n}})}var A=e(80786),_=e(6013),y=e(99125),S=e(42306),O=e(4818),k=e(41435),R=e(71338),w=e(42576),P=e(52216),M=e(70582),L={SEEN:"SEEN",NOT_SEEN:"NOT_SEEN"},D={seen:L.SEEN,not_seen:L.NOT_SEEN},Y=e(79968),U=e(46932),F=e(1324),G=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},e=i.notifications,n=i.alert,o=i.pager;return{notifications:(null==e?void 0:e.map(function(t){var i,e,n,o,a,r,c,s,l,d,u,f,m,p,g,x,T,v,N,h,b,C,I,E,j,A,_;return m=(f=t||{}).id,p=f.title,g=f.message,x=f.images,T=f.date,v=f.url,N=f.main_image,h=f.status,b=f.type,C=f.icon,I=f.action,E=f.expiration_text,j=f.is_expired,A=f.magnet_meta_data,_=f.provider_click_url,{notificationId:m,notificationType:b,notificationTitle:(0,P.U)(p),notificationMessage:(0,P.U)(g),notificationDate:(0,P.U)(T),notificationMainImage:(0,M.W)({data:N}),notificationImages:(null==x?void 0:null===(u=x.map)||void 0===u?void 0:u.call(x,function(t){return(0,M.W)({data:t})}))||[],notificationStatus:D[h],notificationAction:!(0,k.x)(I)&&{notificationActionTitle:(i=I||{}).action_title,notificationActionValue:i.action_value,notificationActionType:i.action_type},notificationUrl:(0,Y.f)({data:v}),notificationIcon:(n=(e=C||{}).image,o=e.background_color,{notificationIconUrl:(0,M.W)({data:n}),notificationIconBackgroundColor:o}),notificationIsExpired:j,notificationExpirationText:(0,P.U)(E),notificationMagnetData:(r=(a=A||{}).to_follow,c=a.name,s=a.username,l=a.bio,d=a.mentioned_comment_id,{notificationMagnetToFollow:r,notificationMagnetType:a.type,notificationMagnetName:c,notificationMagnetBio:(0,P.U)(l),notificationMagnetUsername:s,notificationMagnetMentionedCommentId:d}),notificationClickUrl:_}}))||[],pinNotification:n,pager:(0,U.d)({data:o})}}}),B=e(45227),z=e(8398),q=(0,F.q)({url:"/notification/seen/",type:B.XN.POST,inputTransformer:z.d}),Z=e(31909),K=e(72677);function H(t){var i=t.className;return(0,a.jsxs)("div",{"data-testid":"profile-notifications-empty-state",className:(0,K.d)("bg-neutral-000 flex flex-col items-center justify-center h-full mx-2 py-18 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(Z.E,{width:256,height:192,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-h5 text-neutral-800",children:"هنوز که خبری نیست..."}),(0,a.jsx)("div",{className:"text-body-1 text-neutral-600",children:"پیام‌ها و خبرها را اینجا نمایش خواهیم داد"})]})}function W(t){var i=t.notificationAction||{},e=i.notificationActionTitle,n=i.notificationActionValue;return(0,a.jsxs)("div",{"data-testid":"notification-action-badge",className:"flex items-center gap-1 bg-neutral-100 h-6 rounded-medium-plus px-2",children:[(0,a.jsxs)("p",{className:"text-body-2",children:[e,":"]}),(0,a.jsx)("p",{className:"text-body2-strong tracking-[4px]",children:n})]})}var X=e(98723);function V(t){var i=t.className,e=t.text,n=t.onClick,o=t.to,r=t.pending,c=t.color,l=t.isDisabled;return(0,a.jsx)(X.r,{"data-testid":"notification-action-button",className:(0,K.d)("h-8 flex justify-center items-center text-body2-strong whitespace-nowrap rounded-large px-3 py-1 grow-0 border-[1px] border-solid",i,"high-emphasis"===(void 0===c?"high-emphasis":c)?"text-neutral-650 border-neutral-650":"text-dark-neutral-500 border-dark-neutral-500"),to:o,disabled:l,onClick:!l&&n,children:r?(0,a.jsx)(s.g,{"data-testid":"loading",size:20}):e})}var J=e(36696),Q=e(75490),$=e(47842),tt=e(27314),ti=e(58449),te=(0,F.q)({url:function(t){var i=t.notificationId;return"/notification/".concat(i,"/click/")},type:B.XN.POST,inputTransformer:function(t){return{notificationId:t.notificationId}}}),tn=(0,F.q)({type:B.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),to=e(18814),ta=e.n(to),tr={mobile:36,desktop:44};function tc(t){var i=t.notification,e=t.leftSlot,n=t.bottomSlot,o=t.isLeftSlotCenter,r=i||{},c=r.notificationId,s=r.notificationUrl,l=r.notificationIcon,d=r.notificationTitle,u=r.notificationDate,f=r.notificationMessage,m=r.notificationStatus,g=r.notificationExpirationText,N=r.notificationIsExpired,h=r.notificationClickUrl,b=(0,tt.e)().redirect,E=(0,T.I)(),j=(0,v.v)(_.p.notificationCount),A=(0,x.C)().isDesktop,S=(0,p.E)({apiMethod:tn}).request,O=(0,p.E)({apiMethod:te}).request,R=function(){if(h)try{fetch(h)}catch(t){}};if((0,k.x)(i))return null;var w=(0,ti.k)(f);return(0,a.jsx)("div",{"data-testid":"notification-base-card",className:(0,K.d)("relative py-3 px-4 cursor-pointer",(0,$.Z)({},ta().NotificationBaseCard__background,m===L.NOT_SEEN)),onClick:N?function(){R(),(0,Q.p)({message:g||"این پیام منقضی شده است."})}:function(){R(),b({url:s}),O({notificationId:c}),m===L.NOT_SEEN?(C({notificationId:c}),S({notificationId:c}),E((0,y.d2)(j-1))):I({notificationId:c})},children:(0,a.jsxs)("div",{className:(0,K.d)("z-2 flex gap-2 justify-between text-neutral-900",{"items-center":w||o,"opacity-[50%]":N}),children:[(0,a.jsxs)("div",{className:(0,K.d)("flex gap-3",{"w-full":!e}),children:[(0,a.jsx)(Z.E,{className:"shrink-0",imageClassName:"rounded-circle",height:A?tr.desktop:tr.mobile,width:A?tr.desktop:tr.mobile,src:"/statics/img/svg/profile/notification-default-placeholder.svg",image:null==l?void 0:l.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:d}),!w&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:f}),n,(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,P.U)(u)})]})]}),e?(0,a.jsx)("div",{children:e}):null]})})}function ts(t){var i=t.notification,e=i||{},n=e.notificationAction,r=e.notificationIsExpired,c=(0,o.Z)((0,J.m)(),2),s=(c[0],c[1]),l=(n||{}).notificationActionValue;return(0,a.jsx)(tc,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:"flex justify-between items-center py-3",children:[(0,a.jsx)(W,{notificationAction:n}),(0,a.jsx)(V,{className:"cursor-copy",text:"کپی‌کردن کد",onClick:function(t){t.stopPropagation(),s(l),(0,Q.p)({message:"کد کپی شد"})},isDisabled:r})]})})}var tl={INFORM:"inform",INFORM_ACTION:"inform_action",INFORM_ACTION_IMAGES:"inform_action_images",INFORM_ACTION_COPY:"inform_action_copy",MAGNET:"magnet"},td={mobile:32,desktop:40},tu={mobile:3,desktop:6};function tf(t){var i=t.notificationImages,e=void 0===i?[]:i,o=(0,x.C)().isDesktop,r=o?tu.desktop:tu.mobile,c=e.length-r,s=(0,n.useMemo)(function(){return e.slice(0,r)},[e,r]),l=o?td.desktop:td.mobile;return(0,k.x)(e)?null:(0,a.jsxs)("div",{className:"flex gap-1","data-testid":"profile-notification-images",children:[s.map(function(t){return(0,a.jsx)(Z.E,{imageClassName:"rounded border-complete",image:t,height:l,width:l})}),c>0&&(0,a.jsxs)("div",{style:{height:l,width:l},className:"flex items-center justify-center text-body-2 bg-app-background-mid-dark rounded border-complete",children:[(0,P.U)(c),"+"]})]})}var tm={LINK:"link",COPY:"copy","NONE-COPY":"none-copy"};function tp(t){var i=t.notification,e=i||{},n=e.notificationUrl,o=e.notificationAction,r=e.notificationImages,c=e.notificationIsExpired,s=!(0,k.x)(o),l=(null==o?void 0:o.notificationActionType)===tm.LINK?(0,a.jsx)(V,{text:o.notificationActionTitle,to:n,isDisabled:c}):(0,a.jsx)(W,{notificationAction:o});return(0,a.jsx)(tc,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:(0,K.d)("py-3 flex items-center",(0,k.x)(r)?"justify-end":"justify-between"),children:[(0,a.jsx)(tf,{notificationImages:r||[]}),s?l:null]})})}function tg(t){var i=t.notification,e=i||{},n=e.notificationAction,o=e.notificationUrl,r=e.notificationIsExpired,c=n||{},s=c.notificationActionTitle,l=c.notificationActionType;return(0,a.jsx)(tc,{notification:i,leftSlot:l===tm.LINK?(0,a.jsx)(V,{to:o,text:s,isDisabled:r}):(0,a.jsx)(W,{notificationAction:n})})}var tx={mobile:44,desktop:56};function tT(t){var i=t.notification,e=(i||{}).notificationMainImage,n=(0,x.C)().isDesktop;return(0,a.jsx)(tc,{isLeftSlotCenter:!0,leftSlot:(0,k.x)(e)?null:(0,a.jsx)(Z.E,{"data-testid":"notification-inform-card-image",imageClassName:"rounded",image:e,height:n?tx.desktop:tx.mobile,width:n?tx.desktop:tx.mobile}),notification:i})}var tv={MAGNET_LIKE_CONTENT:"magnet_like_content",MAGNET_FOLLOW:"magnet_follow",MAGNET_COMMENT_CREATED:"magnet_comment_created",MAGNET_MENTIONED:"magnet_mentioned"},tN=e(98780),th=e(74136),tb=e(42663),tC=e(71390),tI=e(19436),tE=e.n(tI),tj={mobile:36,desktop:44};function tA(t){var i=t.notification,e=t.leftSlot,n=(0,tt.e)().redirect,o=(0,x.C)().isDesktop,r=(0,T.I)(),c=(0,v.v)(_.p.notificationCount),s=i.notificationId,l=i.notificationUrl,d=i.notificationIcon,u=i.notificationTitle,f=i.notificationDate,m=i.notificationMessage,g=i.notificationStatus,N=i.notificationIsExpired,h=i.notificationExpirationText,b=i.notificationClickUrl,E=(0,p.E)({apiMethod:tn}).request,j=(0,p.E)({apiMethod:te}).request,A=function(){if(b)try{fetch(b)}catch(t){}},S=(0,ti.k)(m);return(0,tb.xb)(i)?null:(0,a.jsx)("div",{className:(0,tb.dh)("relative py-3 px-4 cursor-pointer",(0,$.Z)({},tE().NotificationMagnetBaseCard__background,g===L.NOT_SEEN)),children:(0,a.jsxs)("div",{className:(0,tb.dh)("z-2 flex gap-2 justify-between text-neutral-900 items-center",{"opacity-[50%]":N}),onClick:N?function(){A(),(0,Q.p)({message:h||"این پیام منقضی شده است."})}:function(){A(),n({url:l}),j({notificationId:s}),g===L.NOT_SEEN?(C({notificationId:s}),E({notificationId:s}),r((0,y.d2)(c-1))):I({notificationId:s})},children:[(0,a.jsxs)("div",{className:(0,tb.dh)("flex gap-3",{"w-full":!e}),children:[(0,a.jsx)(Z.E,{className:"shrink-0",imageClassName:"rounded-circle",height:o?tj.desktop:tj.mobile,width:o?tj.desktop:tj.mobile,src:tC.C,image:null==d?void 0:d.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:u}),!S&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:m}),(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,tb.Uu)(f)})]})]}),e?(0,a.jsx)("div",{children:e}):null]})})}function t_(t){var i=t.notification,e=i||{},n=e.notificationMagnetData,o=e.notificationIsExpired,r=n||{},c=r.notificationMagnetToFollow,s=r.notificationMagnetUsername,l=(0,th.l)({isFollowing:!c,username:s}),d=l.onFollowStateChangeAction,u=l.isFollowing,f=l.pending;return(0,a.jsx)(tA,{notification:i,leftSlot:(0,a.jsx)(V,{className:(0,K.d)("w-22 lg:w-24 cursor-pointer",u&&"border-none"),onClick:function(t){t.preventDefault(),t.stopPropagation(),d()},text:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(tN.J,{icon:u?"cube-content-check":"cube-action-add-person",size:20,color:"high-emphasis"}),(0,a.jsx)("span",{children:u?"دنبال شده":"دنبالش کن"})]}),color:"high-emphasis",pending:f,isDisabled:o})})}var ty={mobile:44,desktop:56};function tS(t){var i=t.notification,e=(0,x.C)().isDesktop,n=(i||{}).notificationMainImage;return(0,a.jsx)(tA,{notification:i,leftSlot:!(0,k.x)(n)&&(0,a.jsx)(Z.E,{imageClassName:"rounded",image:n,height:e?ty.desktop:ty.mobile,width:e?ty.desktop:ty.mobile})})}function tO(t){var i=t.notification;return(0,k.x)(i)?null:i.notificationMagnetData.notificationMagnetType===tv.MAGNET_FOLLOW?(0,a.jsx)(t_,{notification:i}):(0,a.jsx)(tS,{notification:i})}function tk(t){var i=t.notification;if((0,k.x)(i))return null;switch(i.notificationType){case tl.INFORM_ACTION:return(0,a.jsx)(tg,{notification:i});case tl.INFORM_ACTION_IMAGES:return(0,a.jsx)(tp,{notification:i});case tl.INFORM_ACTION_COPY:return(0,a.jsx)(ts,{notification:i});case tl.MAGNET:return(0,a.jsx)(tO,{notification:i});default:return(0,a.jsx)(tT,{notification:i})}}function tR(t){var i=t.className,e=t.notifications;return(0,a.jsx)("div",{"data-testid":"profile-notifications-list",className:(0,K.d)("bg-neutral-000",i),children:null==e?void 0:e.map(function(t){return(0,a.jsx)(tk,{notification:t},t.notificationId)})})}var tw=e(57931);function tP(t){var i=t.className,e=t.shouldShowReadAll,n=t.onReadAll;return e?(0,a.jsx)("div",{"data-testid":"profile-notifications-read-all",className:(0,K.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:(0,a.jsx)(tw.z,{removePadding:!0,shape:"text",color:"black",size:"small",onClick:n,appendIcon:"cube-content-check-double",label:"خواندن همه"})}):null}var tM=e(98634),tL={ALL:{TYPE:"all",ICON:"cube-badge-dk-smile"},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"},MAGNET:{TYPE:"magnet",ICON:"cube-badge-magnet-outline"}},tD=function(t){var i=t.data||{},e=i.title,n=i.color;return{tabNotificationNotSeenCount:i.not_seen_count,tabColor:n,tabTitle:e}},tY=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},e=i.all,n=i.alert,o=i.order,a=i.marketing,r=i.transaction,c=i.magnet;return{allTab:tD({data:e}),alertTab:tD({data:n}),orderTab:tD({data:o}),marketingTab:tD({data:a}),transactionTab:tD({data:r}),magnetTab:tD({data:c})}}}),tU=e(42090),tF=e.n(tU),tG=(0,n.memo)(function(t){var i=t.type,e=t.icon,n=t.isActive,o=t.onTabChange,r=t.notificationTab,c=t.isAllRead,s=t.isTabCollapsed,l=(0,x.C)().isDesktop,d=r||{},u=d.tabTitle,m=d.tabNotificationNotSeenCount;if(!u)return null;var p=!c&&m>0&&i!==tL.ALL.TYPE;return(0,a.jsxs)("div",{onClick:function(){o(i)},className:(0,K.d)("ml-2 p-2 text-body2-strong text-neutral-700 cursor-pointer w-18 lg:w-unset","flex flex-col lg:flex-row items-center justify-center border-complete rounded relative",{"bg-dark-neutral-000 text-white":n},!l&&{"h-9":s,"h-16":!s},tF().transition),children:[(0,a.jsx)(tN.J,{icon:e,size:20,color:n?"white":"neutral-700",className:(0,K.d)(s?"opacity-0":"opacity-100",tF().transition)}),(0,a.jsx)("p",{className:(0,K.d)("lg:mr-1 mt-1 lg:mt-0 whitespace-nowrap",s&&tF().moveUp),children:u}),!(0,S.d)(f.X.AB_NOTIFICATION_BADGE_TOOLTIP)&&p?(0,a.jsx)(tN.J,{className:"lg:static absolute top-0 left-0",icon:"cube-content-dot",size:16,color:n?"white":"primary"}):null]})});function tB(t){var i=t.activeTab,e=void 0===i?"all":i,r=t.onTabChange,c=t.isAllRead,s=t.className,l=(0,n.useRef)(),d=(0,x.C)().isDesktop,u=(0,o.Z)((0,n.useState)(!1),2),f=u[0],m=u[1],p=(0,g.V)({apiMethod:tY}).data,T=p.allTab,v=p.alertTab,N=p.orderTab,h=p.marketingTab,b=p.transactionTab,C=p.magnetTab;return(0,n.useEffect)(function(){var t=(0,tM.P2)(function(){l.current&&!d&&(l.current.getBoundingClientRect().top<=2?m(!0):m(!1))},100);return window.addEventListener("scroll",t),function(){return window.removeEventListener("scroll",t)}},[]),(0,a.jsx)("div",{ref:l,className:(0,K.d)("bg-neutral-000 px-2 lg:px-4 sticky top-0 lg:static z-2 pb-2",s),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar pt-2 lg:pt-0",children:[(0,a.jsx)(tG,{type:tL.ALL.TYPE,icon:tL.ALL.ICON,notificationTab:T,isActive:tL.ALL.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tG,{type:tL.ALERT.TYPE,icon:tL.ALERT.ICON,notificationTab:v,isActive:tL.ALERT.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tG,{type:tL.ORDER.TYPE,icon:tL.ORDER.ICON,notificationTab:N,isActive:tL.ORDER.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tG,{type:tL.MARKETING.TYPE,icon:tL.MARKETING.ICON,notificationTab:h,isActive:tL.MARKETING.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tG,{type:tL.TRANSACTION.TYPE,icon:tL.TRANSACTION.ICON,notificationTab:b,isActive:tL.TRANSACTION.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tG,{type:tL.MAGNET.TYPE,icon:tL.MAGNET.ICON,notificationTab:C,isActive:tL.MAGNET.TYPE===e,onTabChange:r,isAllRead:c,isTabCollapsed:f})]})})}function tz(){var t=(0,x.C)().isDesktop,i=(0,T.I)(),e=(0,o.Z)((0,n.useState)(!1),2),u=e[0],m=e[1],N=(0,o.Z)((0,n.useState)(tL.ALL.TYPE),2),h=N[0],b=N[1],C=(0,o.Z)((0,n.useState)(1),2),I=C[0],A=C[1],O=(0,v.v)(_.p.notificationCount),M=(0,w.M)(),L=M.triggerCustomSurvey,D=M.isInAppSurveyServiceReady,Y=(0,g.V)({apiMethod:G,apiData:{type:h,page:I}}),U=Y.data,F=Y.pending,B=Y.reload,z=(0,p.E)({apiMethod:q,onSuccess:function(){E({unreadNotificationCount:O}),B(),i((0,y.d2)(0)),m(!0)}}).request,Z=(0,n.useCallback)(function(t){b(t),j({tabTitle:t}),D&&L("in-app-survey-notification-change-tab")},[D]),K=U||{},W=K.notifications,X=(K.pinNotification,K.pager),V=function(t){r.NY.scrollToTop({duration:100,smooth:!0}),A(t)};(0,n.useEffect)(function(){A(1)},[h]),(0,n.useEffect)(function(){i((0,y.wi)(0))},[]);var J=(0,n.useMemo)(function(){return F?(0,a.jsx)(s.g,{"data-testid":"profile-notifications-loading",className:"my-50"}):(0,k.x)(W)?(0,a.jsx)(H,{}):(0,a.jsxs)("div",{children:[tL.ALL.TYPE&&(0,a.jsx)(R.S,{className:"pb-3 pt-1 px-2",clientPage:"notification-center-page"}),(0,a.jsx)(tR,{notifications:W}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==X?void 0:X.pagerCurrentPage,pagerTotalPages:null==X?void 0:X.pagerTotalPages,clickAction:V})]})},[F,W,h,null==X?void 0:X.pagerCurrentPage]),Q=(0,c.useRouter)();return(0,a.jsx)("div",{children:(0,a.jsxs)(d.P,{withTitleLine:t,hasTitleInMobile:!0,shouldShowBack:!0,hasHeaderActionInMobile:!0,onBackClicked:function(){Q.back()},title:(0,S.d)(f.X.AB_NOTIFICATION_BADGE_TOOLTIP)?"پیام‌ها":(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{children:"پیام‌ها"}),O?(0,a.jsx)("div",{className:"bg-primary-500 text-caption-compact text-white px-2 rounded-[100px] pt-1 pb-0.5",children:(0,P.U)(O)}):null]}),headerAction:(0,a.jsx)(tP,{className:"lg:mt-0 mt-4",onReadAll:z,shouldShowReadAll:O>0}),children:[(0,a.jsx)(tB,{isAllRead:u,activeTab:h,onTabChange:Z}),J]})})}var tq=e(70865),tZ=e(96670),tK=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},e=i.notifications,n=i.pager;return{notifications:(null==e?void 0:e.map(function(t){var i,e,n,o,a,r,c,s,l,d,u,f,m,p,g;return o=(n=t||{}).id,a=n.title,r=n.message,c=n.images,s=n.date,l=n.action_title,d=n.icon_color,u=n.url,f=n.icon,m=n.main_image,p=n.status,g=(0,M.W)({data:f,prefix:"notificationIcon"}),(0,tZ.Z)((0,tq.Z)({notificationId:o,notificationTitle:null!=a?a:"",notificationMessage:null!=r?r:"",notificationImages:null!==(i=null==c?void 0:c.map(function(t){return(0,M.W)({data:t})}))&&void 0!==i?i:[],notificationStatus:D[p],notificationDate:null!=s?s:"",notificationActionTitle:null!=l?l:"",notificationIconColor:null!=d?d:"",notificationUrl:null!==(e=(0,Y.f)({data:u}))&&void 0!==e?e:"",notificationIcon:(0,M.W)({data:f})},g),{notificationMainImage:(0,M.W)({data:m})})}))||[],pager:(0,U.d)({data:n})}}}),tH=(0,F.q)({url:"/notification/seen/",type:B.XN.POST,inputTransformer:z.d});function tW(t){var i=t.className,e=t.shouldShowReadAll,n=t.onReadAll;return(0,a.jsx)("div",{className:(0,K.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:e&&(0,a.jsx)(tw.z,{shape:"text",color:"secondary",size:"large",onClick:n,prependIcon:"notificationMarkAsRead",iconColor:"secondary",label:"تغییر پیام‌ها به خوانده شده"})})}function tX(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,K.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 py-10 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(Z.E,{width:180,height:135,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-body-1 text-neutral-900",children:"هنوز پیامی نیومده"})]})}function tV(t){var i=t.className,e=t.images,n=t.imageSize,o=t.imageRadius,r=t.imagesAlt,c=t.imageClassName,s=t.maxToDisplay,l=void 0===s?3:s,d=t.withBorder,u=(0,K.d)("flex flex-row gap-4 sm:text text-neutral-500",{"divide-x divide-x-reverse divide-n-100":void 0!==d&&d},i);return(0,a.jsx)("div",{className:u,children:e.map(function(t,i){return i<l?(0,a.jsx)(Z.E,{width:n,height:n,image:t,alt:r,rounded:o,objectFit:"cover",className:c},i):i===l?(0,a.jsx)("div",{className:"flex justify-center items-center pr-6 text-body-1 text-neutral-900",children:"".concat((0,P.U)(e.length-l),"+")},i):null})})}var tJ=(0,F.q)({type:B.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),tQ=e(55917),t$=e.n(tQ);function t0(t){var i=t.notification,e=t.className,n=(0,x.C)().isDesktop,o=(0,p.E)({apiMethod:tJ}).request,r=i.notificationId,c=i.notificationTitle,s=i.notificationMessage,l=i.notificationImages,d=i.notificationUrl,u=i.notificationStatus,f=i.notificationDate,m=i.notificationActionTitle,g=i.notificationIconColor,T=i.notificationIcon,v=i.notificationMainImage,N=function(){if(u!==L.NOT_SEEN){I({notificationId:r});return}o({notificationId:r}).then(function(){C({notificationId:r})})};return(0,a.jsxs)(X.r,{className:(0,K.d)("bg-neutral-000 flex items-start py-4 px-2 lg:px-4 br-list-vertical-no-padding-200",e),to:!n&&d,shouldHandleUrlAndOnClick:!0,onClick:!n&&N,children:[T&&g&&(0,a.jsx)("div",{style:{backgroundColor:g},className:(0,K.d)("flex items-center justify-center ml-4 lg:mr-0 rounded-circle shrink-0",t$().ProfileNotificationsListCard__iconContainer),children:(0,a.jsx)(Z.E,{width:16,height:16,image:T,alt:"Notification Icon"})}),(0,a.jsxs)("div",{className:"grow flex flex-col relative",children:[u===L.NOT_SEEN&&(0,a.jsx)("div",{className:(0,K.d)("absolute rounded-circle bg-secondary-500 z-1",t$().ProfileNotificationsListCard__notSeenDot)}),(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-body1-strong text-neutral-700",children:(0,P.U)(c)}),(0,a.jsx)("p",{className:"text-body-2 text-neutral-500 w-full",children:(0,P.U)(s)})]}),!(0,k.x)(v)&&(0,a.jsx)(Z.E,{width:60,height:60,image:v,alt:"DK-product-notification",className:"mr-2 min-w-15 min-h-15"})]}),!(0,k.x)(l)&&(0,a.jsx)("div",{className:"mt-3 select-none -mr-8 lg:mr-0",children:(0,a.jsx)(tV,{images:l,withBorder:!n,maxToDisplay:n?7:5,imageSize:n?40:32})}),(0,a.jsxs)("div",{className:"flex items-center flex-row-reverse lg:flex-row justify-between mt-3 user-select-none",children:[d&&(0,a.jsx)("div",{onClick:N,children:(0,a.jsxs)(X.r,{to:d,className:"flex items-center text-button-1 text-secondary-500 cursor-pointer",children:[(0,a.jsx)("div",{className:"sm:text",children:m}),(0,a.jsx)(tN.J,{icon:"chevronLeft",size:18,color:"secondary",className:"mr-1"})]})}),(0,a.jsx)("div",{className:"text-neutral-500 xs:text lg:text-xxs",children:(0,P.U)(f)})]})]})]})}function t2(t){var i=t.className,e=t.notifications;return(0,a.jsx)("div",{className:(0,K.d)("bg-neutral-000 mb-6 px-2 lg:px-4",i),children:null==e?void 0:e.map(function(t){return(0,a.jsx)(t0,{notification:t},t.notificationId)})})}var t1=e(74782);function t4(){return(0,a.jsxs)(t1.ZP,{speed:2,viewBox:"0 0 320 66",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb",className:"m-auto w-full h-full",children:[(0,a.jsx)("circle",{cx:"300",cy:"20",r:"8"}),(0,a.jsx)("rect",{x:"146",y:"14",rx:"4",ry:"4",width:"140",height:"10"}),(0,a.jsx)("rect",{x:"16",y:"30",rx:"4",ry:"4",width:"270",height:"20"}),(0,a.jsx)("rect",{x:"16",y:"55",rx:"4",ry:"4",width:"270",height:"10"})]})}function t3(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,K.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 lg:mx-0 mb-10 user-select-none",i),children:[(0,a.jsx)(t4,{}),(0,a.jsx)(t4,{}),(0,a.jsx)(t4,{})]})}var t6={ALL:{TYPE:"all",ICON:""},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"}},t8=function(t){var i=t.data||{},e=i.title;return{tabNotificationCount:i.count,tabColor:i.color,tabTitle:e}},t5=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},e=i.all,n=i.alert,o=i.order,a=i.marketing,r=i.transaction;return{notificationTabsAllCount:null==e?void 0:e.count,notificationTabsAllTitle:null==e?void 0:e.title,notificationTabsAllColor:null==e?void 0:e.color,notificationTabsAlertCount:null==n?void 0:n.count,notificationTabsAlertTitle:null==n?void 0:n.title,notificationTabsAlertColor:null==n?void 0:n.color,notificationTabsOrderCount:null==o?void 0:o.count,notificationTabsOrderTitle:null==o?void 0:o.title,notificationTabsOrderColor:null==o?void 0:o.color,notificationTabsMarketingCount:null==a?void 0:a.count,notificationTabsMarketingTitle:null==a?void 0:a.title,notificationTabsMarketingColor:null==a?void 0:a.color,notificationTabsTransactionCount:null==r?void 0:r.count,notificationTabsTransactionTitle:null==r?void 0:r.title,notificationTabsTransactionColor:null==r?void 0:r.color,allTab:t8({data:e}),alertTab:t8({data:n}),orderTab:t8({data:o}),marketingTab:t8({data:a}),transactionTab:t8({data:r})}}});function t7(t){var i=t.type,e=t.icon,n=t.isActive,o=t.onTabChange,r=t.notificationTab||{},c=r.tabColor,s=r.tabTitle;return s?(0,a.jsxs)(X.r,{onClick:function(){o(i)},className:(0,K.d)("flex items-center text-caption rounded-large py-1 px-3 ml-2 whitespace-nowrap cursor-pointer border-complete-200 text-neutral-700"),style:n?{borderColor:c,color:c}:null,CROId:"profile-messeges-menu",children:[!!e&&(0,a.jsx)(tN.J,{icon:e,size:16,color:n&&c,className:"ml-1"}),s]}):null}function t9(t){var i=t.activeTab,e=void 0===i?"all":i,n=t.onTabChange,o=t.className,r=(0,g.V)({apiMethod:t5}).data,c=r.allTab,s=r.alertTab,l=r.orderTab,d=r.marketingTab,u=r.transactionTab;return(0,a.jsx)("div",{className:(0,K.d)("bg-neutral-000 px-2 lg:px-4",o),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar py-4 lg:py-0",children:[(0,a.jsx)(t7,{type:t6.ALL.TYPE,icon:t6.ALL.ICON,notificationTab:c,isActive:t6.ALL.TYPE===e,onTabChange:n}),(0,a.jsx)(t7,{type:t6.ALERT.TYPE,icon:t6.ALERT.ICON,notificationTab:s,isActive:t6.ALERT.TYPE===e,onTabChange:n}),(0,a.jsx)(t7,{type:t6.ORDER.TYPE,icon:t6.ORDER.ICON,notificationTab:l,isActive:t6.ORDER.TYPE===e,onTabChange:n}),(0,a.jsx)(t7,{type:t6.MARKETING.TYPE,icon:t6.MARKETING.ICON,notificationTab:d,isActive:t6.MARKETING.TYPE===e,onTabChange:n}),(0,a.jsx)(t7,{type:t6.TRANSACTION.TYPE,icon:t6.TRANSACTION.ICON,notificationTab:u,isActive:t6.TRANSACTION.TYPE===e,onTabChange:n})]})})}function it(){var t=(0,T.I)(),i=(0,x.C)().isDesktop,e=(0,o.Z)((0,n.useState)(t6.ALL.TYPE),2),s=e[0],u=e[1],f=(0,o.Z)((0,n.useState)(1),2),m=f[0],N=f[1],h=(0,v.v)(_.p.notificationCount),b=(0,g.V)({apiMethod:tK,apiData:{type:s,page:m}}),C=b.data,I=b.pending,A=b.reload,S=(0,p.E)({apiMethod:tH,onSuccess:function(){E({unreadNotificationCount:h}),A(),t((0,y.d2)(0))}}).request,O=C||{},R=O.notifications,w=O.pager,P=function(t){r.NY.scrollToTop({duration:100,smooth:!0}),N(t)};(0,n.useEffect)(function(){N(1)},[s]);var M=(0,n.useMemo)(function(){return I?(0,a.jsx)(t3,{}):(0,k.x)(R)?(0,a.jsx)(tX,{}):(0,a.jsxs)("div",{children:[(0,a.jsx)(t2,{notifications:R}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==w?void 0:w.pagerCurrentPage,pagerTotalPages:null==w?void 0:w.pagerTotalPages,clickAction:P})]})},[I,R,s,null==w?void 0:w.pagerCurrentPage]),L=(0,c.useRouter)();return(0,a.jsxs)("div",{children:[(0,a.jsx)(d.P,{onBackClicked:function(){L.back()},title:"پیغام‌ها",withTitleLine:!1,isMobileHeaderCard:!0}),(0,a.jsxs)(d.P,{isDesktopHeader:!0,title:"پیغام‌ها",withTitleLine:!0,hasWhiteBackground:!1,headerAction:(0,a.jsx)(tW,{shouldShowReadAll:h>0,onReadAll:S}),children:[!i&&(0,a.jsx)(tW,{shouldShowReadAll:h>0,onReadAll:S}),(0,a.jsx)(t9,{activeTab:s,onTabChange:function(t){u(t),j({tabTitle:t})}}),M]})]})}var ii=(0,O.D)({component:function(){return(0,v.v)(A.b.isPendingInit)?(0,a.jsx)(s.g,{className:"my-25"}):(0,S.d)(f.X.NOTIFICATION_CENTER_REDESIGN)?(0,a.jsx)(tz,{}):(0,a.jsx)(it,{})},layoutProps:{type:u.B.PROFILE,sidebarMenuActiveKey:m.g.NOTIFICATIONS,chatKey:"profile"},isPrivate:!0})},16648:function(t,i,e){"use strict";e.d(i,{R:function(){return r}});var n=e(70865),o=e(52322),a=e(7028);function r(t){return(0,o.jsx)(a.R,(0,n.Z)({},t))}},27876:function(t,i,e){"use strict";e.d(i,{t:function(){return c}});var n=e(70865),o=e(52322),a=e(91898),r=e(27314);function c(t){var i=(0,r.e)().redirect;return(0,o.jsx)(a.t,(0,n.Z)({redirect:i},t))}},71338:function(t,i,e){"use strict";e.d(i,{S:function(){return p}});var n=e(52322),o=e(71473),a=e(43847),r=e(1324),c=(0,r.q)({url:"/social/v1/notification-center/announcement/message/",transformer:function(t){var i=t.data||{};return{title:i.title,description:i.description,icon:i.icon,color:i.color,emphasis:i.emphasis,size:i.size}},inputTransformer:function(t){return{cityId:t.cityId,stateId:t.stateId,clientPage:t.clientPage}},baseURL:function(){return a.V.GATEWAY_API_BASE_URL}}),s=e(72873),l=e(87049),d=e(83050),u=e(6013),f=e(41435),m=(0,r.q)({url:"/magnet/notification-center/announcement/message/",transformer:function(t){var i=t.data||{};return{title:i.title,description:i.description,icon:i.icon,color:i.color,emphasis:i.emphasis,size:i.size}},inputTransformer:function(t){return{cityId:t.cityId,stateId:t.stateId,clientPage:t.clientPage}}});function p(t){var i=t.className,e=t.clientPage,a=t.gateway,r=(0,l.v)(u.p.isLoggedIn),p=(0,l.v)(u.p.userCity),g=(0,l.v)(u.p.userState),x=(0,l.v)(d.E.userDefaultCity),T=r?null==p?void 0:p.cityId:null==x?void 0:x.cityId,v=r?null==g?void 0:g.stateId:null==x?void 0:x.cityStateId,N=(0,s.V)({apiMethod:a?c:m,apiData:{cityId:T,stateId:v,clientPage:e},dependencies:[T,v,e],disabled:!e}),h=N.data,b=N.pending,C=N.hasError;if(b||!T||!v||C||(0,f.x)(h)||!(null==h?void 0:h.description))return null;var I=h||{},E=I.title,j=I.description,A=I.icon,_=I.color,y=I.emphasis,S=I.size;return(0,n.jsx)("div",{className:i,children:(0,n.jsx)(o.kW,{color:_||"warning",emphasis:y||"tonal",size:S||"xl",title:E,description:j,rightIcon:A})})}},41218:function(t,i,e){"use strict";e.d(i,{P:function(){return m}});var n=e(47842),o=e(52322),a=e(16648),r=e(47072),c=e(26442),s=e(64177),l=e(27314),d=e(72677),u=e(33256),f=e.n(u);function m(t){var i=t.children,e=t.className,u=t.title,m=t.headerAction,p=void 0===m?null:m,g=t.withTitleLine,x=t.hideLineInSmallScreen,T=t.hasWhiteBackground,v=t.isMobileHeaderCard,N=t.isDesktopHeader,h=t.hasHeaderActionInMobile,b=t.hasTitleInMobile,C=t.shouldShowBack,I=void 0!==C&&C,E=t.onBackClicked,j=(0,l.e)().redirect,A=(0,s.C)().isDesktop,_=(0,d.d)("mb-4",{"bg-neutral-000":void 0===T||T},e),y=(0,d.d)((0,n.Z)({},f()["ProfileCard__title--mobileHeader"],v));if(v&&A)return null;var S=!!u&&(A&&N||b||v),O=!!p&&(A||h),k=(0,d.d)("flex justify-between items-center lg:py-4 px-4",{"lg:pl-6 lg:pr-4":I});return(0,o.jsxs)(a.R,{className:_,children:[(S||O)&&(0,o.jsxs)("div",{className:k,children:[S&&(0,o.jsx)(r.D,{title:u,withLine:void 0===g||g,className:y,hideLineInSmallScreen:x,rightIcon:!A&&v||I?"arrowRight":null,rightIconOnClick:E||function(){j({url:c._2})}}),O&&p]}),void 0===i?null:i]})}},45873:function(t,i,e){"use strict";e.d(i,{g:function(){return n}});var n={REFERRAL:"REFERRAL",DIGIPLUS:"DIGIPLUS",DASHBOARD:"DASHBOARD",ORDERS:"ORDERS",LISTS:"LISTS",COMMENTS:"COMMENTS",ADDRESSES:"ADDRESSES",GIFT_CARDS:"GIFT_CARDS",NOTIFICATIONS:"NOTIFICATIONS",USER_HISTORY:"USER_HISTORY",USER_INFO:"USER_INFO",LOGOUT:"LOGOUT"}},74136:function(t,i,e){"use strict";e.d(i,{l:function(){return u}});var n=e(66383),o=e(2784),a=e(45227),r=e(1324),c=(0,r.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/follow/")},type:a.XN.POST}),s=(0,r.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/unfollow/")},type:a.XN.POST}),l=e(98634),d=e(11559);function u(t){var i=t.isFollowing,e=t.onSuccess,a=void 0===e?l.ZT:e,r=t.username,u=(0,n.Z)((0,o.useState)(i),2),f=u[0],m=u[1];(0,o.useEffect)(function(){m(i)},[i]);var p=(0,d.E)({apiMethod:c,onSuccess:function(){m(!0),a(!0)}}),g=p.request,x=p.pending,T=(0,d.E)({apiMethod:s,onSuccess:function(){m(!1),a(!1)}}),v=T.request,N=T.pending;return{isFollowing:f,pending:x||N,onFollowStateChangeAction:function(){f?v({username:r}):g({username:r})}}}},42576:function(t,i,e){"use strict";e.d(i,{M:function(){return r}});var n=e(17156),o=e(82650),a=e(94042);function r(){var t=(0,n.NQ)().ready,i=(0,o.z)().emit;return{triggerCustomSurvey:function(t){return i(a.y5,t)},isInAppSurveyServiceReady:t}}},4818:function(t,i,e){"use strict";e.d(i,{D:function(){return m}});var n=e(70865),o=e(52322),a=e(64665),r=e(2784),c=e(5632),s={};function l(t){var i=s[t];void 0!==i&&window.scrollTo(0,i)}var d=e(42306),u=e(98324),f=e.n(u);function m(t){var i=t.component,e=t.getAPIMethods,u=t.layoutProps,m=t.isPrivate,p=t.noDefaultLoader,g=t.pageActivatorFeature,x=t.redirectIfLogin,T=t.afterLogin,v=t.disableSSR,N=t.dataProps,h=t.saveScrollPosition,b=void 0!==h&&h,C=function(t){return(!function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0],i=(0,c.useRouter)(),e=i.pathname;(0,r.useEffect)(function(){if(t){var n=function(){s[e]=window.scrollY},o=function(){setTimeout(function(){l(e)},0)};i.events.on("routeChangeStart",n),i.events.on("routeChangeComplete",o);var a=setTimeout(function(){l(e)},1e3);return function(){clearTimeout(a),i.events.off("routeChangeStart",n),i.events.off("routeChangeComplete",o)}}},[e,i,t])}(b),(0,d.d)(a.X.LITE_PAGE_ANIMATION))?(0,o.jsx)("div",{className:f().container,children:(0,o.jsx)(i,(0,n.Z)({},t))}):(0,o.jsx)(i,(0,n.Z)({},t))};return C.getAPIMethods=e,C.layoutProps=u,C.isPrivate=m,C.noDefaultLoader=p,C.pageActivatorFeature=g,C.redirectIfLogin=x,C.afterLogin=T,C.disableSSR=v,C.dataProps=N,C.saveScrollPosition=b,C}},18814:function(t){t.exports={NotificationBaseCard__background:"styles_NotificationBaseCard__background__MfBKU"}},19436:function(t){t.exports={NotificationMagnetBaseCard__background:"styles_NotificationMagnetBaseCard__background__ghR1k"}},42090:function(t){t.exports={transition:"styles_transition__KOxGG",moveUp:"styles_moveUp__2Yvve"}},55917:function(t){t.exports={ProfileNotificationsListCard__iconContainer:"styles_ProfileNotificationsListCard__iconContainer__1rmpg",ProfileNotificationsListCard__notSeenDot:"styles_ProfileNotificationsListCard__notSeenDot__6TmpF"}},33256:function(t){t.exports={"ProfileCard__title--mobileHeader":"styles_ProfileCard__title--mobileHeader__Tpkul"}},98324:function(t){t.exports={container:"styles_container__TOHrJ","fade-out":"styles_fade-out__Z1zNL"}}},function(t){t.O(0,[9774,2888,179],function(){return t(t.s=83514)}),_N_E=t.O()}]);
