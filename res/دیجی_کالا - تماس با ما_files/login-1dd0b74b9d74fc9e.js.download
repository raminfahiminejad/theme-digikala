(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9861],{19401:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/login",function(){return n(47657)}])},67602:function(e,t,n){"use strict";n.d(t,{W:function(){return l}});var r=n(70865),o=n(96670),s=n(66383),i=n(52322),a=n(2784),u=n(21494);function l(e){var t=(0,s.Z)((0,a.useState)(!1),2),n=t[0],l=t[1],c=function(){l(function(e){return!e})};return(0,i.jsx)(u.I,(0,o.Z)((0,r.Z)({},e),{type:n?"text":"password",leftIcon:n?"visibilityOff":"visibilityOn",leftIconOnClick:function(e){e.stopPropagation(),c()}}))}},60465:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r={auth:"AUTH",password:"PASSWORD",otp:"OTP",register:"REGISTER"}},47657:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ea}});var r=n(52322),o=n(88589),s=n(4818),i=n(66383),a=n(2784),u=n(5632),l=n(8050),c=n(7969),d=n(64665),f=n(43202),m=n(87049),p=n(86768),h=n(5911),v=n(80786),x=n(42306),g=n(59218),w=n(67163),N=n(29890),j=n(60465),_=n(59437),b=n(57931),y=n(16137),S=n(21494),O=n(27768),P=n(8290),k=n(96495),C=n(26442),I=n(11559),L=n(70387),T=n(52536),R=n(45227),E=n(1324),D=n(21154),U=(0,E.q)({type:R.XN.POST,url:"user/authenticate/",transformer:function(e){var t=e.data||{};return{hasPassword:t.has_password,hasAccount:t.has_account,loginMethod:t.login_method,timer:t.sms_ttl,username:t.phone}},inputTransformer:function(e){return{username:(null==e?void 0:e.username)||(null==e?void 0:e.phone),otp_call:(null==e?void 0:e.otpCall)||!1,force_send_otp:null==e?void 0:e.forceSendOtp,hash:(0,D.Y)()?window.DigikalaLiteAPI.otpHash:null}}});function M(e){var t=e.setStep,n=e.setResponse,o=e.setUsername,s=(0,L.O)().sendInTrackUserEvent,i=(0,I.E)({apiMethod:U,onSuccess:function(e){return(n(e),e.hasAccount)?e.loginMethod===k.e.PASSWORD?t(j.w.password):t(j.w.otp):t(j.w.register)}}),a=i.request,u=i.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"ورود | ثبت‌نام"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 mt-4 text-right w-full",children:"سلام!"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 mb-4 text-right w-full",children:"لطفا شماره موبایل یا ایمیل خود را وارد کنید"}),(0,r.jsx)(y.l,{useFormProps:{mode:"onBlur"},onSubmit:function(e){var t=e.username.trim();s({eventName:P.M.LOGIN_CONTINUE,eventData:{isValid:!0,isMobile:(0,T.k8)(t)}}),o(t),a({username:t})},items:[{component:(0,r.jsx)(S.I,{autoFocus:!0,inputWrapperProps:{fullWidth:!0}}),name:"username",defaultValue:"",rules:{required:O.Qt,validate:T.jI}},{component:(0,r.jsx)(b.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-6 lg:mt-8 text-button-1",isLoading:u,CROId:"login-register",children:"ورود"})}]}),(0,r.jsxs)("p",{className:"text-caption text-neutral-700 mt-4",children:["ورود شما به معنای پذیرش",(0,r.jsx)(_.e,{mode:"link",href:C.A2,className:"mx-1 inline-block text-secondary-700",children:"شرایط دیجی‌کالا"}),"و",(0,r.jsx)(_.e,{mode:"link",href:C.SL,className:"mx-1 inline-block text-secondary-700",children:"قوانین حریم‌خصوصی"}),"است"]})]})}var z=n(98780),A=n(25509),W=n(64952),Z=n(57394),q=n(90247),F=n(99125),G=n(73076),J=n(52216);function B(e){var t,n=e.response,o=e.setStep,s=e.setResponse,u=(0,i.Z)((0,a.useState)(""),2),l=u[0],c=u[1],d=(0,q.c)(),f=d.ref,m=d.submit,h=(0,L.O)().sendInTrackUserEvent,v=(0,a.useRef)(new Date),x=(0,Z.J)({action:F.y}),g=x.request,w=x.pending,N=(0,I.E)({apiMethod:U,onSuccess:function(e){return s(e)},onError:function(e){var t;return c(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)}}),_=N.request,S=N.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"کد تایید را وارد کنید"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 my-4 text-right w-full",children:"کد تایید برای شماره ".concat((0,J.U)(n.username)," پیامک شد")}),(0,r.jsx)(y.l,{ref:f,onSubmit:function(e){h({eventName:P.M.LOGIN_CONFIRM,eventData:{isOTP:!0,isNewUser:!1}}),g({username:n.username,code:(0,G.d)(e.code),type:k.e.OTP}).then(function(){return(0,p.IJ)()})},items:[{component:(0,r.jsx)(A.N,{submit:m,shouldUseWebOTP:!0}),name:"code",defaultValue:"",rules:{validate:{numberValidation:T.AU,length5:function(e){return 5===e.length||O.VP}}}}]}),n.hasPassword&&(0,r.jsxs)(b.z,{mode:"text",color:"secondary",size:"small",className:"mt-4",onClick:function(){h({eventName:P.M.PASSWORD_LOGIN}),o(j.w.password)},removePadding:!0,children:["ورود با رمز عبور",(0,r.jsx)(z.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsx)(W.U,{error:l,endTime:1e3*n.timer+(null===(t=v.current)||void 0===t?void 0:t.getTime()),onResend:function(e){var t=e.otpCall;v.current=new Date,_({username:n.username,forceSendOtp:!0,otpCall:void 0!==t&&t})},isLoading:S}),(0,r.jsx)(b.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-4",isLoading:w,CROId:"login-verification-code",onClick:m,children:"تایید"})]})}var H=n(98742),V=n(27314),X=n(68344),Y=n.n(X),K=n(67602);function Q(e){var t=e.setStep,n=e.setResponse,o=e.response,s=e.username,i=(0,V.e)().redirect,a=(0,q.c)(),u=a.ref,l=a.submit,c=(0,L.O)().sendInTrackUserEvent,d=(0,Z.J)({action:F.y}),f=d.request,m=d.pending,h=(0,I.E)({apiMethod:U,onSuccess:function(e){n(e),t(j.w.otp)}}),v=h.request,x=h.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full my-4",children:"رمز عبور را وارد کنید"}),(0,r.jsx)(y.l,{ref:u,onSubmit:function(e){c({eventName:P.M.LOGIN_CONFIRM,eventData:{isOTP:!1,isNewUser:!1}}),f({username:s,password:e.password,type:k.e.PASSWORD}).then(function(e){(null==e?void 0:e.shouldConfirmPhone)&&i({url:C.ih}),(0,p.qx)()})},items:[{component:(0,r.jsx)(K.W,{isRequired:!0,helper:" ",autoFocus:!0,inputWrapperProps:{fullWidth:!0}}),name:"password",defaultValue:"",rules:{required:O.gt}}]}),o.username&&(0,r.jsxs)(b.z,{mode:"text",color:"secondary",size:"small",onClick:function(){c({eventName:P.M.OTP_LOGIN}),v({username:o.username,forceSendOtp:!0})},className:"mt-3 p-0",removePadding:!0,isLoading:x,children:["ورود با رمز یک‌بار‌مصرف",(0,r.jsx)(z.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsxs)(b.z,{mode:"text",color:"secondary",size:"small",onClick:function(){c({eventName:P.M.FORGET_PASSWORD}),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:360,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Y().set(r,e,t,{maxAge:86400*n,path:"/",secure:!g.yG})}(H.x,o.username||s||""),i({url:C.sx})},className:"mt-3 p-0",removePadding:!0,children:["فراموشی رمز عبور",(0,r.jsx)(z.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),(0,r.jsx)(b.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-8",isLoading:m,onClick:l,children:"تایید"})]})}var $=n(58013),ee=n(77251),et=n(79593),en=n(42204),er=n(23004),eo=(0,E.q)({type:R.XN.POST,url:"user/register/confirm/",inputTransformer:function(e){return{username:e.username,code:e.code}}});function es(e){var t=e.response,n=e.setResponse,o=(0,$.Z)({},(0,ee.Z)((0,u.useRouter)())),s=(0,V.e)().redirect,l=(0,a.useRef)(new Date),c=(0,q.c)(),d=c.ref,m=c.submit,h=(0,L.O)().sendInTrackUserEvent,v=(0,i.Z)((0,a.useState)(""),2),x=v[0],g=v[1],w=(0,I.E)({apiMethod:U,onSuccess:function(e){return n(e)},onError:function(e){var t;return g(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.message)}}),N=w.request,j=w.pending,_=(0,I.E)({apiMethod:eo,onSuccess:function(){(0,p.ZY)();var e=(0,er.p)(f.z0),t=(0,en.Z)({query:f.hD}),n=(0,en.Z)({query:f.Su}),r=t||n||(0,C.ws)();if("true"===e&&t){var i=r.toString();if(!et.s&&i.startsWith("http")){window.location.href=i;return}History.length>0?o.replace(r):o.replace((0,C.ws)()).then(function(){return o.push(r)})}s({url:C.iR})}}),S=_.request,k=_.pending;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("h1",{className:"text-h4 text-neutral-900 text-right w-full mt-4",children:"کد تایید را وارد کنید"}),(0,r.jsx)("p",{className:"text-body-2 text-neutral-700 my-4 text-right w-full",children:"حساب کاربری با شماره موبایل\n        ".concat((0,J.U)(t.username),"\n        وجود ندارد. برای ساخت حساب جدید، کد تایید برای این شماره ارسال گردید.")}),(0,r.jsx)(y.l,{ref:d,onSubmit:function(e){h({eventName:P.M.LOGIN_CONFIRM,eventData:{isOTP:!0,isNewUser:!0}}),S({username:t.username,code:e.code})},items:[{component:(0,r.jsx)(A.N,{submit:m}),name:"code",defaultValue:"",rules:{validate:{numberValidation:T.AU,length5:function(e){return 5===e.length||O.VP}}}}]}),(0,r.jsx)(W.U,{error:x,isLoading:j,endTime:1e3*t.timer+l.current.getTime(),onResend:function(e){var n=e.otpCall;l.current=new Date,N({username:t.username,forceSendOtp:!0,otpCall:void 0!==n&&n})}}),(0,r.jsx)(b.z,{type:"submit",color:"primary",size:"large",mode:"filled",className:"w-full mt-6 lg:mt-8",isLoading:k,onClick:m,children:"ادامه"})]})}function ei(e){var t=e.className,n=(0,i.Z)((0,a.useState)(j.w.auth),2),o=n[0],s=n[1],_=(0,i.Z)((0,a.useState)(null),2),b=_[0],y=_[1],S=(0,i.Z)((0,a.useState)(""),2),O=S[0],P=S[1],k=(0,u.useRouter)().query,C=(0,x.d)(d.X.DK_WEB_SSO)&&g.yv,I=(0,m.v)(v.b.isPendingInit);(0,a.useEffect)(function(){var e=(0,N.k)(k.backUrl)?k.backUrl[0]:k.backUrl;e&&(0,p.Jb)({url:e})},[]),(0,a.useEffect)(function(){if((0,x.d)(d.X.DK_WEB_SSO)&&g.yv&&!I){var e=(0,N.k)(k.backUrl)?k.backUrl[0]:k.backUrl,t=(0,w.R)(e);(0,h.aR)(t).then(function(e){window.location.replace(e)})}},[C,I,k.backUrl]);var L=o!==j.w.auth,T=(0,N.k)(k[f.hD])?k[f.hD][0]:k[f.hD];return C||I?null:(0,r.jsxs)(l.p,{className:t,children:[(0,r.jsx)(c.G,{setStep:s,firstStep:j.w.auth,hasBack:L||!!T,shouldDefaultBack:!L,backUrl:L?void 0:T,logoHiddenInMobile:L,isIconFixedMobile:!0}),function(){switch(o){case j.w.auth:return(0,r.jsx)(M,{setStep:s,setResponse:y,setUsername:P});case j.w.password:return(0,r.jsx)(Q,{setStep:s,response:b,setResponse:y,username:O});case j.w.otp:return(0,r.jsx)(B,{setStep:s,response:b,setResponse:y});case j.w.register:return(0,r.jsx)(es,{response:b,setResponse:y});default:return null}}()]})}var ea=(0,s.D)({component:function(){return(0,r.jsx)(ei,{})},redirectIfLogin:!0,layoutProps:{type:o.B.CENTER,shouldDisableIntrackModal:!0,justify:"center"}})},8050:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(47842),o=n(52322),s=n(72677),i=n(77997),a=n.n(i);function u(e){var t=e.children,n=e.className,i=e.width,u=(0,s.d)("lg:border-complete-200 rounded-medium p-5 lg:p-8","flex flex-col items-center justify-start lg:justify-center",(0,r.Z)({},a().AccountWrapper__mainBox,!i),i,n);return(0,o.jsx)("div",{className:u,children:t})}},25509:function(e,t,n){"use strict";n.d(t,{N:function(){return x}});var r=n(70865),o=n(26297),s=n(66383),i=n(52322),a=n(2784),u=n(21494),l=n(21154),c=n(73076),d=n(41435),f=n(83632);function m(){(0,f.g)("in read otp function");var e=new AbortController;(0,f.g)("in the otp event"),navigator.credentials.get({otp:{transparent:["sms"]},signal:e.signal}).then(function(e){return(0,f.g)("otp executed"),null==e?void 0:e.code}).catch(function(t){(0,f.g)(t),e.abort()})}var p=n(72677),h=n(82023),v=n.n(h);function x(e){var t=e.onChange,n=e.error,f=e.name,h=e.codeLength,x=void 0===h?5:h,g=e.submit,w=e.inputWrapperProps,N=e.shouldUseWebOTP,j=void 0!==N&&N,_=(0,o.Z)(e,["onChange","error","name","codeLength","submit","inputWrapperProps","shouldUseWebOTP"]),b=(0,s.Z)((0,a.useState)(""),2),y=b[0],S=b[1];(0,a.useEffect)(function(){var e;if((0,l.Y)())return null===(e=window.DigikalaLiteAPI)||void 0===e?void 0:e.watch("AUTO_FILL_OTP",function(e){var n=e.payload;t(O((0,c.d)(n))),S(n.split("").join("-")),P(n)})},[]),(0,a.useEffect)(function(){if(j&&(0,d.x)(y)&&"OTPCredential"in window)return window.addEventListener("DOMContentLoaded",m),function(){return window.removeEventListener("DOMContentLoaded",m)}},[y]);var O=function(e){return null==e?void 0:e.replace(/[-]/g,"")},P=function(e){e.length===x&&setTimeout(function(){g()},0)};return(0,i.jsx)(u.I,(0,r.Z)({name:void 0===f?"code":f,onChange:function(e){var n=e.target.value;if(n.length<2*x-1){t(O((0,c.d)(n)));var r,o,s,i=null==n?void 0:null===(r=n.split)||void 0===r?void 0:null===(o=r.call(n,""))||void 0===o?void 0:null===(s=o.join)||void 0===s?void 0:s.call(o,"-");(i&&Number(O(i))||""===i)&&S(i)}P(n)},autoFocus:!0,maxLength:x+Math.round(x/2)+1,inputMode:"numeric",type:"text",inputClassName:(0,p.d)("text-center",v().codeInput__trackingOtp),value:y,error:n,inputWrapperProps:void 0===w?{fullWidth:!0}:w,autoComplete:j&&"one-time-code"},_))}},64952:function(e,t,n){"use strict";n.d(t,{U:function(){return u}});var r=n(52322),o=n(57931),s=n(98780),i=n(3005),a=n(72677);function u(e){var t=e.error,n=e.endTime,u=e.onResend,l=e.isLoading,c=e.shouldHideOTPCall,d=e.buttonColor,f=e.descriptionColor,m=void 0===f?"text-neutral-700":f,p=(0,i.J)(n,{hasHours:!1}),h=function(){u({otpCall:!1})};return t?(0,r.jsx)("p",{className:(0,a.d)("w-full mt-4 text-center text-body-2 py-2",m),children:t}):n&&0!==p?(0,r.jsxs)("p",{className:(0,a.d)("w-full mt-4 text-center text-body-2 py-2",m),children:[(0,r.jsx)("span",{className:"w-10 inline-block mx-1 text-center",children:p}),"مانده تا دریافت مجدد کد"]}):void 0!==c&&c?(0,r.jsx)(o.z,{mode:"text",size:"small",color:void 0===d?"secondary":d,onClick:h,isLoading:l,className:"mt-4 w-full",children:"دریافت مجدد کد تایید"}):(0,r.jsxs)("div",{className:"w-full flex items-center justify-center mb-6 mt-4 text-caption user-select-none",children:["دریافت مجدد کد از طریق",(0,r.jsxs)("span",{onClick:h,className:"flex items-center text-secondary-500 mx-2 cursor-pointer",children:["پیامک",(0,r.jsx)(s.J,{icon:"chevronLeft",size:20,color:"secondary"})]}),"یا",(0,r.jsxs)("span",{onClick:function(){u({otpCall:!0})},className:"flex items-center text-secondary-500 mx-2 cursor-pointer",children:["تماس",(0,r.jsx)(s.J,{icon:"chevronLeft",size:20,color:"secondary"})]})]})}},7969:function(e,t,n){"use strict";n.d(t,{G:function(){return m}});var r=n(47842),o=n(52322),s=n(59437),i=n(98780),a=n(31909),u=n(26442),l=n(27314),c=n(72677),d=n(29030),f=n.n(d);function m(e){var t=e.hasBack,n=e.setStep,d=e.firstStep,m=e.backUrl,p=e.width,h=e.isIconFixedMobile,v=e.logoHiddenInMobile,x=e.shouldDefaultBack,g=(0,l.e)(),w=g.redirect,N=g.back,j=(0,c.d)("transform transition-all duration-500 ease-out",{"scale-60":t}),_=(0,c.d)("right-0 text-neutral-700 transition-all duration-300 ease-out",(0,r.Z)({"00 cursor-pointer":t,"opacity-0 pointer-events-none":!t,absolute:!h,"fixed lg:absolute ":h},f().Logo__icon,h));return(0,o.jsxs)("div",{className:"w-full relative flex items-center justify-center mb-3",children:[(0,o.jsx)(i.J,{icon:"arrowRight",size:24,onClick:function(){if(x&&N(),m){w({url:m});return}null==n||n(d)},className:_}),(0,o.jsx)(s.e,{href:(0,u.ws)(),className:(0,c.d)({"hidden lg:block":v}),children:(0,o.jsx)(a.E,{className:j,width:void 0===p?100:p,src:"/brand/full-vertical.svg",alt:"لوگوی دیجیکالا"})})]})}},4818:function(e,t,n){"use strict";n.d(t,{D:function(){return m}});var r=n(70865),o=n(52322),s=n(64665),i=n(2784),a=n(5632),u={};function l(e){var t=u[e];void 0!==t&&window.scrollTo(0,t)}var c=n(42306),d=n(98324),f=n.n(d);function m(e){var t=e.component,n=e.getAPIMethods,d=e.layoutProps,m=e.isPrivate,p=e.noDefaultLoader,h=e.pageActivatorFeature,v=e.redirectIfLogin,x=e.afterLogin,g=e.disableSSR,w=e.dataProps,N=e.saveScrollPosition,j=void 0!==N&&N,_=function(e){return(!function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,a.useRouter)(),n=t.pathname;(0,i.useEffect)(function(){if(e){var r=function(){u[n]=window.scrollY},o=function(){setTimeout(function(){l(n)},0)};t.events.on("routeChangeStart",r),t.events.on("routeChangeComplete",o);var s=setTimeout(function(){l(n)},1e3);return function(){clearTimeout(s),t.events.off("routeChangeStart",r),t.events.off("routeChangeComplete",o)}}},[n,t,e])}(j),(0,c.d)(s.X.LITE_PAGE_ANIMATION))?(0,o.jsx)("div",{className:f().container,children:(0,o.jsx)(t,(0,r.Z)({},e))}):(0,o.jsx)(t,(0,r.Z)({},e))};return _.getAPIMethods=n,_.layoutProps=d,_.isPrivate=m,_.noDefaultLoader=p,_.pageActivatorFeature=h,_.redirectIfLogin=v,_.afterLogin=x,_.disableSSR=g,_.dataProps=w,_.saveScrollPosition=j,_}},77997:function(e){e.exports={AccountWrapper__mainBox:"account-wrapper_AccountWrapper__mainBox__cC78z"}},82023:function(e){e.exports={codeInput__trackingOtp:"styles_codeInput__trackingOtp__mhz1j"}},29030:function(e){e.exports={Logo__icon:"logo_Logo__icon__bHD2_"}},98324:function(e){e.exports={container:"styles_container__TOHrJ","fade-out":"styles_fade-out__Z1zNL"}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=19401)}),_N_E=e.O()}]);
